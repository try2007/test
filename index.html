<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=UTF-8">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:Consolas;
	panose-1:2 11 6 9 2 2 4 3 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:8.0pt;
	margin-left:0cm;
	line-height:107%;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
h1
	{mso-style-link:"Заголовок 1 Знак";
	margin-right:0cm;
	margin-left:0cm;
	font-size:24.0pt;
	font-family:"Times New Roman",serif;
	font-weight:bold;}
h2
	{mso-style-link:"Заголовок 2 Знак";
	margin-right:0cm;
	margin-left:0cm;
	font-size:18.0pt;
	font-family:"Times New Roman",serif;
	font-weight:bold;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
p
	{margin-right:0cm;
	margin-left:0cm;
	font-size:12.0pt;
	font-family:"Times New Roman",serif;}
code
	{font-family:"Courier New";}
pre
	{mso-style-link:"Стандартный HTML Знак";
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Courier New";}
span.1
	{mso-style-name:"Заголовок 1 Знак";
	mso-style-link:"Заголовок 1";
	font-family:"Times New Roman",serif;
	font-weight:bold;}
span.2
	{mso-style-name:"Заголовок 2 Знак";
	mso-style-link:"Заголовок 2";
	font-family:"Times New Roman",serif;
	font-weight:bold;}
p.msonormal0, li.msonormal0, div.msonormal0
	{mso-style-name:msonormal;
	margin-right:0cm;
	margin-left:0cm;
	font-size:12.0pt;
	font-family:"Times New Roman",serif;}
span.tm-svg-iconwrapper
	{mso-style-name:tm-svg-icon__wrapper;}
span.tm-article-reading-timelabel
	{mso-style-name:tm-article-reading-time__label;}
span.tm-icon-counter
	{mso-style-name:tm-icon-counter;}
span.tm-icon-countervalue
	{mso-style-name:tm-icon-counter__value;}
span.tm-publication-hublink-container
	{mso-style-name:tm-publication-hub__link-container;}
span.tm-article-snippetprofiled-hub
	{mso-style-name:tm-article-snippet__profiled-hub;}
span.HTML
	{mso-style-name:"Стандартный HTML Знак";
	mso-style-link:"Стандартный HTML";
	font-family:"Courier New";}
span.5
	{mso-style-name:\037C5;}
span.6
	{mso-style-name:\037C6;}
span.e
	{mso-style-name:\037Ce;}
span.4
	{mso-style-name:\037C4;}
span.7
	{mso-style-name:\037C7;}
span.9
	{mso-style-name:\037C9;}
span.8
	{mso-style-name:\037C8;}
.MsoChpDefault
	{font-family:"Calibri",sans-serif;}
.MsoPapDefault
	{margin-bottom:8.0pt;
	line-height:107%;}
@page WordSection1
	{size:595.3pt 841.9pt;
	margin:2.0cm 42.5pt 2.0cm 3.0cm;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>

</head>

<body lang=RU link=blue vlink=purple>
<div id="cf36440629ca5b2ca63ea0eae8a041fc" class="ww-informers-box-854753"><p class="ww-informers-box-854754"><a href="https://world-weather.ru/pogoda/russia/moscow/14days/">Подробнее о погоде в Москве на 2 недели</a><br><a href="https://world-weather.ru/">world-weather.ru</a></p></div><script async type="text/javascript" charset="utf-8" src="https://world-weather.ru/wwinformer.php?userid=cf36440629ca5b2ca63ea0eae8a041fc"></script><style>.ww-informers-box-854754{-webkit-animation-name:ww-informers54;animation-name:ww-informers54;-webkit-animation-duration:1.5s;animation-duration:1.5s;white-space:nowrap;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;font-size:12px;font-family:Arial;line-height:18px;text-align:center}@-webkit-keyframes ww-informers54{0%,80%{opacity:0}100%{opacity:1}}@keyframes ww-informers54{0%,80%{opacity:0}100%{opacity:1}}</style>
<div class=WordSection1>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Графика в
Пайтон – расширение </span><span lang=EN-US style='font-size:13.5pt;font-family:
"Arial",sans-serif;color:black'>Pillow</span><span style='font-size:13.5pt;
font-family:"Arial",sans-serif;color:black'> (Ранее известное как </span><span
lang=EN-US style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Pil</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>)</span></p>

<p class=MsoNormal style='margin-top:18.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Pillow это
развитие PIL — оригинальной библиотеки Python для работы с изображениями.
Несмотря на то, что существуют другие более продвинутые библиотеки Python для
обработки изображений, Pillow остается важным инструментом для понимания и
работы в целом, кроме того - его инструменты весьма похожи на инструменты </span><span
lang=EN-US style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Adobe</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'> (</span><span
lang=EN-US style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>photoshop</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>)</span></p>

<p class=MsoNormal style='margin-top:42.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:18.0pt;font-family:"Arial",sans-serif;color:black'>Основные
операции с изображениями в библиотеке Python Pillow</span></p>

<p class=MsoNormal style='margin-top:9.0pt;margin-right:0cm;margin-bottom:0cm;
margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Библиотека
Python Pillow является ответвлением более старой библиотеки под названием PIL.
PIL расшифровывается как Python Imaging Library. В Python есть много модулей
для работы с изображениями и их обработки. Если вы хотите работать с
изображениями напрямую, оперируя их пикселями, вы можете использовать NumPy и
SciPy. Другими популярными библиотеками для обработки изображений являются
OpenCV, scikit-image и Mahotas. Некоторые из этих библиотек быстрее и мощнее,
чем Pillow. Для начинающих однако </span><span lang=EN-US style='font-size:
13.5pt;font-family:"Arial",sans-serif;color:black'>Pillow</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'> является
предпочтительным вариантом для задач обработки изображений высокого уровня,
которые не требуют более продвинутых навыков обработки.</span></p>

<p class=MsoNormal style='margin-top:18.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Вам нужно
будет установить библиотеку, прежде чем вы сможете ее использовать. Вы можете
установить Pillow с помощью pip в виртуальной среде (</span><span lang=EN-US
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>terminal</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'> – где мы
писали </span><span lang=EN-US style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>pip</span><span lang=EN-US style='font-size:13.5pt;font-family:
"Arial",sans-serif;color:black'> </span><span lang=EN-US style='font-size:13.5pt;
font-family:"Arial",sans-serif;color:black'>install</span><span lang=EN-US
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'> </span><span
lang=EN-US style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>telebot</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>):</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>PS&gt;
python -m venv venv<br>
PS&gt; .\venv\Scripts\activate (venv)</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>PS&gt;
python -m pip install Pillow</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Теперь,
когда вы установили пакет, вы готовы начать знакомство с библиотекой Python
Pillow и выполнять основные операции с изображениями.</span></p>

<p class=MsoNormal style='margin-top:42.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:18.0pt;font-family:"Arial",sans-serif;color:black'>Модуль Image
и класс Image в Pillow</span></p>

<p class=MsoNormal style='margin-top:9.0pt;margin-right:0cm;margin-bottom:0cm;
margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Основным
классом, определенным в Pillow, является класс Image. Когда вы читаете
изображение с помощью Pillow, оно сохраняется как объект типа Image.</span></p>

<p class=MsoNormal style='margin-top:18.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Вы должны
помнить что файл с изображения нужно поместить в корневую папку проекта, в
котором работаете. При изучении изображений с помощью Pillow лучше всего
использовать интерактивную среду </span><span lang=EN-US style='font-size:13.5pt;
font-family:"Arial",sans-serif;color:black'>Pyton</span><span lang=EN-US
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'> </span><span
lang=EN-US style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Console</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'> (REPL - первая
кнопка из набора где и кнопка </span><span lang=EN-US style='font-size:13.5pt;
font-family:"Arial",sans-serif;color:black'>terminal</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>). Начните
с открытия изображения, которое вы только что скачали:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:10.0pt;font-family:Consolas;color:black'>&gt;&gt;&gt; </span><b><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:#8959A8'>from</span></b><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'> </span><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>PIL</span><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'> </span><b><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:#8959A8'>import</span></b><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'> </span><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>Image</span><span
style='font-size:10.0pt;font-family:Consolas;color:black'><br>
&gt;&gt;&gt; </span><span lang=EN-US style='font-size:10.0pt;font-family:Consolas;
color:black'>filename</span><span style='font-size:10.0pt;font-family:Consolas;
color:black'> = &quot;</span><span lang=EN-US style='font-size:10.0pt;
font-family:Consolas;color:black'>buildings</span><span style='font-size:10.0pt;
font-family:Consolas;color:black'>.</span><span lang=EN-US style='font-size:
10.0pt;font-family:Consolas;color:black'>jpg</span><span style='font-size:10.0pt;
font-family:Consolas;color:black'>&quot;<br>
&gt;&gt;&gt; </span><b><span lang=EN-US style='font-size:10.0pt;font-family:
Consolas;color:#8959A8'>with</span></b><span lang=EN-US style='font-size:10.0pt;
font-family:Consolas;color:black'> </span><span lang=EN-US style='font-size:
10.0pt;font-family:Consolas;color:black'>Image</span><span style='font-size:
10.0pt;font-family:Consolas;color:black'>.</span><span lang=EN-US
style='font-size:10.0pt;font-family:Consolas;color:black'>open</span><span
style='font-size:10.0pt;font-family:Consolas;color:black'>(</span><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>filename</span><span
style='font-size:10.0pt;font-family:Consolas;color:black'>) </span><b><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:#8959A8'>as</span></b><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'> </span><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>img</span><span
style='font-size:10.0pt;font-family:Consolas;color:black'>:<br>
...     </span><span lang=EN-US style='font-size:10.0pt;font-family:Consolas;
color:black'>img.load()<br>
...<br>
<br>
&gt;&gt;&gt; type(img)<br>
&lt;</span><b><span lang=EN-US style='font-size:10.0pt;font-family:Consolas;
color:#8959A8'>class</span></b><span lang=EN-US style='font-size:10.0pt;
font-family:Consolas;color:black'> 'PIL.JpegImagePlugin.JpegImageFile'&gt;<br>
<br>
&gt;&gt;&gt; isinstance(img, Image.Image)<br>
</span><b><span lang=EN-US style='font-size:10.0pt;font-family:Consolas;
color:#8959A8'>True</span></b></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Вы можете
ожидать импорта из Pillow, а не из PIL. В конце концов, вы установили Pillow, а
не PIL. Однако Pillow — это ответвление библиотеки PIL. Поэтому вам все равно
придется использовать PIL при импорте в ваш код.</span></p>

<p class=MsoNormal style='margin-top:18.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Вы
вызываете функцию&nbsp;</span><span style='font-size:13.5pt;font-family:Consolas;
color:black'>open()</span><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>&nbsp;для чтения изображения из файла и&nbsp;</span><span
style='font-size:13.5pt;font-family:Consolas;color:black'>.load()</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>&nbsp;для
чтения в память, чтобы теперь файл можно было закрыть. Вы используете
оператор&nbsp;</span><span style='font-size:13.5pt;font-family:Consolas;
color:black'>with</span><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>&nbsp;для создания менеджера контекста, чтобы обеспечить закрытие
файла после всех операций. В этом примере объект представляет собой тип
изображения JPEG, который является подклассом класса&nbsp;</span><span
style='font-size:13.5pt;font-family:Consolas;color:black'>Image</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>, что
подтверждается вызовом&nbsp;</span><span style='font-size:13.5pt;font-family:
Consolas;color:black'>isinstance()</span><span style='font-size:13.5pt;
font-family:"Arial",sans-serif;color:black'>. Обратите внимание, что и класс, и
модуль, в котором определен класс, имеют одно и то же имя&nbsp;</span><span
style='font-size:13.5pt;font-family:Consolas;color:black'>Image</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>. Вы можете
отобразить изображение, используя&nbsp;</span><span style='font-size:13.5pt;
font-family:Consolas;color:black'>.show()</span><span style='font-size:13.5pt;
font-family:"Arial",sans-serif;color:black'>:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:10.0pt;font-family:Consolas;color:black'>img.show()</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Метод&nbsp;</span><span
style='font-size:13.5pt;font-family:Consolas;color:black'>.show()</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>&nbsp;сохраняет
изображение как временный файл и отображает его, используя собственное
программное обеспечение вашей операционной системы для работы с изображениями.
Когда вы запустите приведенный выше код, вы увидите следующее изображение:</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'><img width=532 height=352 id="Рисунок 48"
src="PillowKAN.files/image001.jpg" alt="файл building.jpg"></span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>файл
building.jpg</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>В некоторых
системах вызов&nbsp;</span><span style='font-size:13.5pt;font-family:Consolas;
color:black'>.show()</span><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>&nbsp;блокирует REPL, пока вы не закроете изображение. Это зависит
от операционной системы и программного обеспечения для просмотра изображений по
умолчанию, которое вы используете.</span></p>

<p class=MsoNormal style='margin-top:18.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Вам
необходимо ознакомиться с тремя ключевыми свойствами при работе с изображениями
в библиотеке Python Pillow. Вы можете изучить их, используя атрибуты
класса&nbsp;</span><span style='font-size:13.5pt;font-family:Consolas;
color:black'>Image .format</span><span style='font-size:13.5pt;font-family:
"Arial",sans-serif;color:black'>,&nbsp;</span><span style='font-size:13.5pt;
font-family:Consolas;color:black'>.size</span><span style='font-size:13.5pt;
font-family:"Arial",sans-serif;color:black'>&nbsp;и&nbsp;</span><span
style='font-size:13.5pt;font-family:Consolas;color:black'>.mode</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>&gt;&gt;&gt;
img.format<br>
'JPEG'<br>
<br>
&gt;&gt;&gt; img.size<br>
(1920, 1273)<br>
<br>
&gt;&gt;&gt; img.mode<br>
'RGB'</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:Consolas;color:black'>format</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>показывает,
с каким типом изображения вы работаете. В данном случае - JPEG.&nbsp;</span><span
style='font-size:13.5pt;font-family:Consolas;color:black'>size</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>&nbsp;показывает
ширину и высоту изображения.&nbsp;</span><span style='font-size:13.5pt;
font-family:Consolas;color:black'>mode </span><span style='font-size:13.5pt;
font-family:"Arial",sans-serif;color:black'>(режим) этого изображения -
&quot;RGB&quot;.</span></p>

<p class=MsoNormal style='margin-top:18.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Часто вам
может понадобиться обрезать и изменить размер изображения. Класс Image имеет
два метода, которые можно использовать для выполнения этих операций: .</span><span
style='font-size:13.5pt;font-family:Consolas;color:black'>crop()</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>&nbsp;и .</span><span
style='font-size:13.5pt;font-family:Consolas;color:black'>resize()</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>&gt;&gt;&gt;
cropped_img = img.crop((300, 150, 700, 1000))<br>
&gt;&gt;&gt; cropped_img.size<br>
(400, 850)<br>
<br>
&gt;&gt;&gt; cropped_img.show()<br>
<br>
&gt;&gt;&gt; low_res_img = cropped_img.resize(<br>
...     (cropped_img.width // 4, cropped_img.height // 4)<br>
... )<br>
&gt;&gt;&gt; low_res_img.show()</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Аргумент .</span><span
style='font-size:13.5pt;font-family:Consolas;color:black'>crop()</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>&nbsp;должен
состоять из четырех элементов, определяющих левый, верхний, правый и нижний
края области, которую вы хотите обрезать. Система координат, используемая в
Pillow, назначает координаты (0, 0) пикселю в верхнем левом углу. Это та же
система координат, которая обычно используется для двумерных массивов. Кортеж
из четырех элементов представляет собой следующую область изображения:</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'><img width=508 height=340 src="PillowKAN.files/image002.png"
alt="  - Описание: Область кадрирования"></span><span style='font-size:13.5pt;
font-family:"Arial",sans-serif;color:black'>Область кадрирования</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Новое
изображение, которое .</span><span style='font-size:13.5pt;font-family:Consolas;
color:black'>crop()</span><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>&nbsp;возвращает в приведенном выше коде, имеет размер 400x850
пикселей. На обрезанном изображении видно только одно из зданий с исходной
картинки:</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'><img width=166 height=353 id="Рисунок 46"
src="PillowKAN.files/image003.jpg" alt="Обрезанная часть изображения"></span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Обрезанная
часть изображения</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>В
приведенном выше коде вы также изменяете разрешение обрезанного изображения с
помощью&nbsp;</span><span style='font-size:13.5pt;font-family:Consolas;
color:black'>.resize(),</span><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>&nbsp;которому требуется кортеж в качестве обязательного
аргумента. Данный кортеж определяет новую ширину и высоту изображения в
пикселях.</span></p>

<p class=MsoNormal style='margin-top:18.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>В
приведенном выше примере вы устанавливаете новую ширину и высоту в четверть их
исходных значений, используя оператор деления без остатка (//) и атрибуты
изображения&nbsp;</span><span style='font-size:13.5pt;font-family:Consolas;
color:black'>.width</span><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>&nbsp;и .</span><span style='font-size:13.5pt;font-family:Consolas;
color:black'>height</span><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>. Последний вызов&nbsp;</span><span style='font-size:13.5pt;
font-family:Consolas;color:black'>show()</span><span style='font-size:13.5pt;
font-family:"Arial",sans-serif;color:black'>&nbsp;отображает обрезанное
изображение с измененным размером:</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'><img width=100 height=212 id="Рисунок 45"
src="PillowKAN.files/image004.jpg" alt="Сжатое изображение"></span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Сжатое
изображение</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Есть
дополнительные необязательные параметры, которые можно использовать с .</span><span
style='font-size:13.5pt;font-family:Consolas;color:black'>resize()</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>&nbsp;для
управления тем, как изображение масштабирутся. В качестве альтернативы вы
можете использовать аналогичный метод масштабирования, используя&nbsp;</span><span
style='font-size:13.5pt;font-family:Consolas;color:black'>.reduce()</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>low_res_img
= cropped_img.reduce(4)</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Аргумент
определяет коэффициент, на который вы уменьшаете масштаб изображения. Если вы
хотите установить максимальный размер, а не коэффициент масштабирования, вы
можете использовать&nbsp;</span><span style='font-size:13.5pt;font-family:Consolas;
color:black'>.thumbnail()</span><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>. Размер эскиза будет меньше или равен установленному вами
размеру.</span></p>

<p class=MsoNormal style='line-height:normal'><b><span style='font-size:13.5pt;
font-family:"Arial",sans-serif;color:black'>Примечание.</span></b><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>&nbsp;Метод&nbsp;</span><span
style='font-size:13.5pt;font-family:Consolas;color:black'>.thumbnail()</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>&nbsp;изменяет
объект изображения, но не возвращает новый объект. Однако методы .</span><span
style='font-size:13.5pt;font-family:Consolas;color:black'>crop()</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>,&nbsp;</span><span
style='font-size:13.5pt;font-family:Consolas;color:black'>.resize()</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>&nbsp;и .</span><span
style='font-size:13.5pt;font-family:Consolas;color:black'>reduce()</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>&nbsp;возвращают
новый объект изображения. Не все методы в библиотеке Pillow ведут себя
одинаково.</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Когда вы
довольны возвращенным изображением, вы можете сохранить любой из объектов Image
в файл, используя .</span><span style='font-size:13.5pt;font-family:Consolas;
color:black'>save()</span><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>cropped_img.save(&quot;cropped_image.jpg&quot;)<br>
low_res_img.save(&quot;low_resolution_cropped_image.png&quot;)</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Как только
вы вызываете метод, он создает файлы изображений в папке вашего проекта. В этом
примере одно из изображений является изображением в формате JPEG, а другое —
изображением в формате PNG. Расширение, которое вы используете в качестве имени
файла, автоматически определяет формат файла. Также вы можете указать формат в
качестве дополнительного необязательного аргумента.</span></p>

<p class=MsoNormal style='margin-top:42.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:18.0pt;font-family:"Arial",sans-serif;color:black'>Основные
манипуляции с использованием модуля Image</span></p>

<p class=MsoNormal style='margin-top:9.0pt;margin-right:0cm;margin-bottom:0cm;
margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Вы можете
оперировать изображением не только с помощью обрезки и изменения размера.
Другим распространенным методом является поворот или отражение . Вы можете
использовать метод&nbsp;</span><span style='font-size:13.5pt;font-family:Consolas;
color:black'>.transpose()</span><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>&nbsp;для некоторых преобразований. Продолжайте с той же сессией
REPL, которую вы начали в предыдущем разделе:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>converted_img
= img.transpose(Image.FLIP_TOP_BOTTOM)<br>
converted_img.show()</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Этот код
отображает следующее изображение:</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'><img width=651 height=431 id="Рисунок 44"
src="PillowKAN.files/image005.jpg" alt="Перевернутое изображние"></span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Перевернутое
изображние</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Есть семь
опций, которые вы можете передать в качестве аргументов .transpose():</span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:36.0pt;margin-bottom:.0001pt;text-indent:-18.0pt;line-height:normal;
background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span></span><span
style='font-size:13.5pt;font-family:Consolas;color:black'>Image.FLIP_LEFT_RIGHT</span><b><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>:</span></b><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>&nbsp;переворачивает
изображение слева направо, в результате чего получается зеркальное отображение.</span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:36.0pt;margin-bottom:.0001pt;text-indent:-18.0pt;line-height:normal;
background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span></span><span
style='font-size:13.5pt;font-family:Consolas;color:black'>Image.FLIP_TOP_BOTTOM</span><b><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>:</span></b><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>&nbsp;переворачивает
изображение сверху вниз.</span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:36.0pt;margin-bottom:.0001pt;text-indent:-18.0pt;line-height:normal;
background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span></span><span
style='font-size:13.5pt;font-family:Consolas;color:black'>Image.ROTATE_90</span><b><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>:</span></b><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>&nbsp;поворачивает
изображение на 90 градусов против часовой стрелки.</span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:36.0pt;margin-bottom:.0001pt;text-indent:-18.0pt;line-height:normal;
background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span></span><span
style='font-size:13.5pt;font-family:Consolas;color:black'>Image.ROTATE_180</span><b><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>:</span></b><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>&nbsp;поворачивает
изображение на 180 градусов.</span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:36.0pt;margin-bottom:.0001pt;text-indent:-18.0pt;line-height:normal;
background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span></span><span
style='font-size:13.5pt;font-family:Consolas;color:black'>Image.ROTATE_270</span><b><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>:</span></b><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>&nbsp;изображение
поворачивается на 270 градусов против часовой стрелки, что соответствует
повороту на 90 градусов по часовой стрелке.</span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:36.0pt;margin-bottom:.0001pt;text-indent:-18.0pt;line-height:normal;
background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>6.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span></span><span
style='font-size:13.5pt;font-family:Consolas;color:black'>Image.TRANSPOSE</span><b><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>:</span></b><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>&nbsp;перемещает
строки и столбцы, используя верхний левый пиксель в качестве источника, при
этом верхний левый пиксель в перемещенном изображении такой же, как и в
исходном изображении.</span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:36.0pt;margin-bottom:.0001pt;text-indent:-18.0pt;line-height:normal;
background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>7.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span></span><span
style='font-size:13.5pt;font-family:Consolas;color:black'>Image.TRANSVERSE</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>:
перемещает строки и столбцы, используя нижний левый пиксель в качестве
источника, при этом нижний левый пиксель остается фиксированным относительно
исходной и измененной версиями.</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>Все параметры поворота, представленные выше, определяют повороты с
шагом в 90 градусов. Если вам нужно повернуть изображение на другой угол, вы
можете использовать&nbsp;</span><span style='font-size:13.5pt;font-family:Consolas;
color:black'>.rotate()</span><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>rotated_img
= img.rotate(45)<br>
rotated_img.show()</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Этот метод
поворачивает изображение на 45 градусов против часовой стрелки, возвращая
следующее изображение:</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'><img width=625 height=414 id="Рисунок 43"
src="PillowKAN.files/image006.jpg" alt="Изображение повернуто на 45 градусов"></span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Изображение
повернуто на 45 градусов</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Данный
объект Image имеет тот же размер, что и исходное изображение. Поэтому на
дисплее отсутствуют углы картинки. Вы можете изменить это поведение с помощью
расширенного именованного параметра:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>rotated_img
= img.rotate(45, expand=</span><b><span lang=EN-US style='font-size:10.0pt;
font-family:Consolas;color:#8959A8'>True</span></b><span lang=EN-US
style='font-size:10.0pt;font-family:Consolas;color:black'>)<br>
rotated_img.show()</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Этот метод
возвращает увеличенное изображение, полностью содержащее повернутое
изображение:</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'><img width=605 height=605 id="Рисунок 42"
src="PillowKAN.files/image007.jpg"
alt="Повернутое изображение увеличенного размера"></span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Повернутое
изображение увеличенного размера</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Вы можете
дополнительно настроить вращение с другими параметрами. Теперь вы изменили
размер и ориентацию картинки. В следующем разделе вы узнаете о различных типах
изображений в библиотеке Python Pillow.</span></p>

<p class=MsoNormal style='margin-top:42.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:18.0pt;font-family:"Arial",sans-serif;color:black'>Градации и
режимы модуля Image в библиотеке Python Pillow</span></p>

<p class=MsoNormal style='margin-top:9.0pt;margin-right:0cm;margin-bottom:0cm;
margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Изображение
представляет собой двумерный массив пикселей, где каждый пиксель соответствует
цвету. Каждый пиксель может быть представлен одним или несколькими значениями.
Например, в изображении RGB каждый пиксель представлен тремя значениями,
соответствующими значениям красного, зеленого и синего.</span></p>

<p class=MsoNormal style='margin-top:18.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Таким
образом, объект&nbsp;</span><span style='font-size:13.5pt;font-family:Consolas;
color:black'>Image</span><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>&nbsp;для изображения RBG содержит три параметра, по одному для
каждого цвета. Изображение RGB размером 100x100 пикселей представлено массивом
значений 100x100x3.</span></p>

<p class=MsoNormal style='margin-top:18.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Изображения
RGBA также включают значение альфа-параметра, которое содержит информацию о
прозрачности каждого пикселя. Изображение RGBA имеет четыре режима, по одному
для каждого из цветов и четвертый, содержащую альфа-значения. Каждый режим
имеет те же размеры, что и размеры изображения. Таким образом, RGBA-изображение
размером 100x100 пикселей представляется массивом значений 100x100x4.</span></p>

<p class=MsoNormal style='margin-top:18.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Режим
изображения описывает, с каким типом изображения вы работаете. Pillow
поддерживает большинство стандартных режимов, включая черно-белый (двоичный),
оттенки серого, RGB, RGBA и CMYK. Вы можете найти полный список поддерживаемых
режимов в документации Pillow. Также вы можете узнать, сколько слоев(режимов) в
объекте изображения, используя метод&nbsp;</span><span style='font-size:13.5pt;
font-family:Consolas;color:black'>.getbands(),</span><span style='font-size:
13.5pt;font-family:"Arial",sans-serif;color:black'>&nbsp;и вы можете
конвертировать между режимами, используя&nbsp;</span><span style='font-size:
13.5pt;font-family:Consolas;color:black'>.convert()</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>. Теперь вы
будете использовать изображение с именем «strawberry.jpg» </span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'><img width=627 height=418 id="Рисунок 41"
src="PillowKAN.files/image008.jpg" alt=strawberry.jpg></span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>strawberry.jpg</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Режим этого
изображения также RGB. Вы можете преобразовать это изображение в другие режимы.
Данный код использует тот же сеанс REPL, который вы использовали в предыдущих
разделах:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>&gt;&gt;&gt;
filename = &quot;strawberry.jpg&quot;<br>
&gt;&gt;&gt; </span><b><span lang=EN-US style='font-size:10.0pt;font-family:
Consolas;color:#8959A8'>with</span></b><span lang=EN-US style='font-size:10.0pt;
font-family:Consolas;color:black'> Image.open(filename) </span><b><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:#8959A8'>as</span></b><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'> img:<br>
...     img.load()<br>
...<br>
<br>
&gt;&gt;&gt; cmyk_img = img.convert(&quot;CMYK&quot;)<br>
&gt;&gt;&gt; gray_img = img.convert(&quot;L&quot;)  # Grayscale<br>
<br>
&gt;&gt;&gt; cmyk_img.show()<br>
&gt;&gt;&gt; gray_img.show()<br>
<br>
&gt;&gt;&gt; img.getbands()<br>
('R', 'G', 'B')<br>
&gt;&gt;&gt; cmyk_img.getbands()<br>
('C', 'M', 'Y', 'K')<br>
&gt;&gt;&gt; gray_img.getbands()<br>
('L',)</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Вы
вызываете .</span><span style='font-size:13.5pt;font-family:Consolas;
color:black'>convert()</span><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>&nbsp;дважды, чтобы преобразовать изображение RGB в версию CMYK и
в версию в градациях серого. Изображение CMYK похоже на исходное изображение,
но закодировано с использованием режима, характерного для печатных материалов,
а не для цифровых дисплеев. Преобразование в оттенки серого дает следующий
результат:</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'><img width=624 height=416 id="Рисунок 40"
src="PillowKAN.files/image009.jpg" alt="Изображение в градациях серого"></span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Изображение
в градациях серого</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Выходные
данные вызовов .</span><span style='font-size:13.5pt;font-family:Consolas;
color:black'>getbands()</span><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>&nbsp;подтверждают наличие трех слоев в изображении RGB, четырех
слоев в изображении CMYK и одного слоя в изображении в градациях серого.</span></p>

<p class=MsoNormal style='margin-top:18.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Вы можете
разделить изображение на его слои, используя .</span><span style='font-size:
13.5pt;font-family:Consolas;color:black'>split()</span><span style='font-size:
13.5pt;font-family:"Arial",sans-serif;color:black'>, и объединить отдельные
полосы обратно в объект изображения, используя&nbsp;</span><span
style='font-size:13.5pt;font-family:Consolas;color:black'>merge()</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>. Когда вы
используете .</span><span style='font-size:13.5pt;font-family:Consolas;
color:black'>split()</span><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>, метод возвращает все полосы как отдельные объекты изображения.
Вы можете проверить это, отобразив строковое представление одного из
возвращенных объектов:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>&gt;&gt;&gt;
red, green, blue = img.split()<br>
&gt;&gt;&gt; red<br>
&lt;PIL.Image.Image image mode=L size=1920x1281 at 0x7FDD80C9AFA0&gt;<br>
&gt;&gt;&gt; red.mode<br>
'L'</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Режим
объекта, который возвращает .</span><span style='font-size:13.5pt;font-family:
Consolas;color:black'>split()</span><span style='font-size:13.5pt;font-family:
"Arial",sans-serif;color:black'>, — «L», что указывает на то, что это
изображение в градациях серого или же изображение отображает только значения
яркости каждого пикселя.</span></p>

<p class=MsoNormal style='margin-top:18.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Теперь вы
можете создать три новых изображения RGB, отображенных к красном, зеленом и
синем диапазоне, используя функцию&nbsp;</span><span style='font-size:13.5pt;
font-family:Consolas;color:black'>merge(),</span><span style='font-size:13.5pt;
font-family:"Arial",sans-serif;color:black'>&nbsp;которая является функцией
модуля&nbsp;</span><span style='font-size:13.5pt;font-family:Consolas;
color:black'>Image</span><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>&gt;&gt;&gt;
zeroed_band = red.point(</span><b><span lang=EN-US style='font-size:10.0pt;
font-family:Consolas;color:#8959A8'>lambda</span></b><span lang=EN-US
style='font-size:10.0pt;font-family:Consolas;color:black'> _: 0)<br>
<br>
&gt;&gt;&gt; red_merge = Image.merge(<br>
...     &quot;RGB&quot;, (red, zeroed_band, zeroed_band)<br>
... )<br>
<br>
&gt;&gt;&gt; green_merge = Image.merge(<br>
...     &quot;RGB&quot;, (zeroed_band, green, zeroed_band)<br>
... )<br>
<br>
&gt;&gt;&gt; blue_merge = Image.merge(<br>
...     &quot;RGB&quot;, (zeroed_band, zeroed_band, blue)<br>
... )<br>
<br>
&gt;&gt;&gt; red_merge.show()<br>
&gt;&gt;&gt; green_merge.show()<br>
&gt;&gt;&gt; blue_merge.show()</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Первый
аргумент в функции&nbsp;</span><span style='font-size:13.5pt;font-family:Consolas;
color:black'>merge()</span><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>&nbsp;определяет слой изображения, которое вы хотите создать.
Второй аргумент содержит отдельные слои, которые вы хотите объединить в одно
изображение.</span></p>

<p class=MsoNormal style='margin-top:18.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Один
красный режим, сохраненный в переменной red, представляет собой изображение в
градациях серого с режимом L. Чтобы создать изображение, показывающее только
красный слой, вы объединяете красный диапазон из исходного изображения с
зеленым и синем режимами, которые содержат только нули. Чтобы создать
слой(режим), содержащий повсюду нули, вы используете метод .</span><span
style='font-size:13.5pt;font-family:Consolas;color:black'>point()</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>.</span></p>

<p class=MsoNormal style='margin-top:18.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Этому
методу нужна функция в качестве аргумента. Используемая функция определяет, как
преобразуется каждая точка. В данном случае вы используете лямбда-функцию,
чтобы сопоставить каждую точку с 0.</span></p>

<p class=MsoNormal style='margin-top:18.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Когда вы
объединяете красный режим с зеленым и синим, содержащими нули, вы получаете
изображение RGB с именем&nbsp;</span><span style='font-size:13.5pt;font-family:
Consolas;color:black'>red_merge</span><span style='font-size:13.5pt;font-family:
"Arial",sans-serif;color:black'>. Таким образом, созданное вами изображение RGB
имеет ненулевые значения только в красном режиме, но, поскольку это все еще
изображение RGB, оно будет отображаться в цвете.</span></p>

<p class=MsoNormal style='margin-top:18.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Вы также
повторяете аналогичный процесс, чтобы получить&nbsp;</span><span
style='font-size:13.5pt;font-family:Consolas;color:black'>green_merge</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>&nbsp;и&nbsp;</span><span
style='font-size:13.5pt;font-family:Consolas;color:black'>blue_merge</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>, которые
содержат изображения RGB с зеленым и синим режимами из исходного изображения.
Код отображает следующие три изображения:</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'><img width=644 height=162 src="PillowKAN.files/image010.png"
alt="  - Описание: https://habrastorage.org/getpro/habr/upload_files/9a0/676/30e/9a067630e9cf00028d144252c76f2bd7.webp"></span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Красное
изображение содержит сильный сигнал в пикселях, представляющих клубнику, потому
что эти пиксели в основном красные. Зеленый и синий каналы показывают эти
пиксели как темные, потому что они имеют малые значения. Исключением являются
те пиксели, которые представляют собой отражение света на поверхности клубники,
поскольку эти пиксели почти белые.</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>&nbsp;</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>&nbsp;</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>Создание общего изображения из нескольких</span></p>

<p class=MsoNormal><span style='font-size:10.0pt;line-height:107%;font-family:
Consolas;color:black'><br>
<br>
</span><span style='font-size:12.0pt;line-height:107%;font-family:"Times New Roman",serif'>Когда
требуется вывести несколько изображений рядом друг с другом, сохраненных одним
файлом, можно воспользоваться следующей функцией:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
6.0pt;margin-left:0cm;line-height:normal'><b><span lang=EN-US style='font-size:
10.0pt;font-family:Consolas;color:#8959A8'>from</span></b><span lang=EN-US
style='font-size:10.0pt;font-family:Consolas'> PIL <b><span style='color:#8959A8'>import</span></b>
Image<br>
<br>
<b><span style='color:#8959A8'>def</span></b> tile(*images, vertical=<b><span
style='color:#8959A8'>False</span></b>):<br>
    width, height = images[0].width, images[0].height<br>
    tiled_size = (<br>
        (width, height * len(images))<br>
        <b><span style='color:#8959A8'>if</span></b> vertical<br>
        <b><span style='color:#8959A8'>else</span></b> (width * len(images),
height)<br>
    )<br>
    tiled_img = Image.new(images[0].mode, tiled_size)<br>
    row, col = 0, 0<br>
    <b><span style='color:#8959A8'>for</span></b> image <b><span
style='color:#8959A8'>in</span></b> images:<br>
        tiled_img.paste(image, (row, col))<br>
        <b><span style='color:#8959A8'>if</span></b> vertical:<br>
            col += height<br>
        <b><span style='color:#8959A8'>else</span></b>:<br>
            row += width<br>
<br>
    <b><span style='color:#8959A8'>return</span></b> tiled_img</span></p>

<p class=MsoNormal style='margin-top:42.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:18.0pt;font-family:"Arial",sans-serif;color:black'>Обработка
изображений с помощью Pillow в Python</span></p>

<p class=MsoNormal style='margin-top:9.0pt;margin-right:0cm;margin-bottom:0cm;
margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Вы узнали,
как обрезать и поворачивать изображения, изменять их размер и изменять градации
цвета изображений. Однако ни одно из действий, которые вы предприняли до сих
пор, не внесло никаких изменений в содержимое изображения. В этом разделе вы
узнаете о функциях обработки изображений в библиотеке Python Pillow. Вы будете
использовать модуль&nbsp;</span><span style='font-size:13.5pt;font-family:Consolas;
color:black'>ImageFilter</span><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>&nbsp;в Pillow.</span></p>

<p class=MsoNormal style='margin-top:42.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:18.0pt;font-family:"Arial",sans-serif;color:black'>Фильтры
изображений с использованием Convolution Kernels (ядра свертки)</span></p>

<p class=MsoNormal style='margin-top:9.0pt;margin-right:0cm;margin-bottom:0cm;
margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Одним из
методов, используемых при обработке изображений, является свертка изображений с
использованием ядер (Convolution Kernels). Цель этого урока не в том, чтобы
дать подробное объяснение теории обработки изображений. Если вас интересует
наука об обработке изображений, одним из лучших ресурсов, который вы можете
использовать, является&nbsp;</span><a
href="https://www.amazon.co.uk/dp/9353062985/?tag=adnruk-21" target="_blank"><i><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;text-decoration:none'>Digital
Image Processing&nbsp;by Gonzalez and Woods.</span></i></a></p>

<p class=MsoNormal style='margin-top:42.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:18.0pt;font-family:"Arial",sans-serif;color:black'>Размытие
изображения, повышение резкости и сглаживание</span></p>

<p class=MsoNormal style='margin-top:9.0pt;margin-right:0cm;margin-bottom:0cm;
margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Вернемся к
изображению зданий, которое использовали в начале урока. Можно</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'> </span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>начать</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'> </span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>новую</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'> </span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>сессию</span><span
lang=EN-US style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>
REPL </span><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>для</span><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'> </span><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>этого</span><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'> </span><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>раздела</span><span lang=EN-US style='font-size:13.5pt;font-family:
"Arial",sans-serif;color:black'>:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><b><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:#8959A8'>from</span></b><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'> PIL </span><b><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:#8959A8'>import</span></b><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'> Image,
ImageFilter<br>
filename = &quot;buildings.jpg&quot;<br>
</span><b><span lang=EN-US style='font-size:10.0pt;font-family:Consolas;
color:#8959A8'>with</span></b><span lang=EN-US style='font-size:10.0pt;
font-family:Consolas;color:black'> Image.open(filename) </span><b><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:#8959A8'>as</span></b><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'> img:<br>
    img.load()</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>В
дополнение к модулю Image вы также импортируете модуль ImageFilter из Pillow.
Вы можете использовать метод .</span><span style='font-size:13.5pt;font-family:
Consolas;color:black'>filter()</span><span style='font-size:13.5pt;font-family:
"Arial",sans-serif;color:black'>&nbsp;для применения фильтрации к изображению. Этот
метод требует ядра свертки в качестве аргумента, и вы можете использовать одно
из нескольких ядер, доступных в модуле ImageFilter в Pillow. Первый набор
фильтров, о котором вы узнаете, касается размытия, повышения резкости и
сглаживания изображения.</span></p>

<p class=MsoNormal style='margin-top:18.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Вы можете
размыть изображение с помощью фильтра ImageFilter.BLUR:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>blur_img =
img.filter(ImageFilter.BLUR)<br>
blur_img.show()</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Отображаемое
изображение является размытой версией исходного изображения. Вы можете
увеличить масштаб, чтобы увидеть разницу более подробно, используя&nbsp;</span><span
style='font-size:13.5pt;font-family:Consolas;color:black'>.crop()</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>, а затем
снова отобразить изображения, используя .</span><span style='font-size:13.5pt;
font-family:Consolas;color:black'>show()</span><span style='font-size:13.5pt;
font-family:"Arial",sans-serif;color:black'>:</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'><img border=0 width=400 height=200 id="Рисунок 34"
src="PillowKAN.files/image011.jpg"
alt="Два обрезанных изображения показывают разницу между двумя версиями:"></span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Два
обрезанных изображения показывают разницу между двумя версиями:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Вы можете
настроить необходимый тип и степень размытия, используя&nbsp;</span><span
style='font-size:13.5pt;font-family:Consolas;color:black'>ImageFilter.BoxBlur()</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>&nbsp;или&nbsp;</span><span
style='font-size:13.5pt;font-family:Consolas;color:black'>ImageFilter.GaussianBlur()</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>img.filter(ImageFilter.BoxBlur(5)).show()<br>
img.filter(ImageFilter.BoxBlur(20)).show()<br>
img.filter(ImageFilter.GaussianBlur(20)).show()</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Теперь
имеется три размытых изображения, показанные в том же порядке, что и в
приведенном выше коде:</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'><img border=0 width=507 height=992
src="PillowKAN.files/image012.png"
alt="  - Описание: https://habrastorage.org/getpro/habr/upload_files/139/6f7/26e/1396f726e29de938aa0e1445d700d64d.webp"></span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Фильтр&nbsp;</span><span
style='font-size:13.5pt;font-family:Consolas;color:black'>.BoxBlur()</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>&nbsp;аналогичен
фильтру, описанному в предыдущем разделе, где представлены ядра свертки.
Аргументом является радиус фильтра размытия прямоугольника. В предыдущем
разделе, посвященном ядрам, использовался фильтр рамочного размытия 3x3. Это
означает, что он имел радиус 1, потому что фильтр простирается на один пиксель
от центра.</span></p>

<p class=MsoNormal style='margin-top:18.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Размытые
изображения показывают, что прямоугольный фильтр размытия с радиусом 20 создает
более размытое изображение, чем изображение, сгенерированное прямоугольным
фильтром размытия с радиусом 5.</span></p>

<p class=MsoNormal style='margin-top:18.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Вы также
можете использовать фильтр .</span><span style='font-size:13.5pt;font-family:
Consolas;color:black'>GaussianBlur()</span><span style='font-size:13.5pt;
font-family:"Arial",sans-serif;color:black'>, который использует ядро
&#8203;&#8203;размытия по Гауссу. Ядро Гаусса придает больший вес пикселям в
центре ядра, чем по краям, и это приводит к более плавному размытию, чем то,
что получается с размытием прямоугольника. По этой причине во многих случаях
размытие по Гауссу может дать лучшие результаты.</span></p>

<p class=MsoNormal style='margin-top:18.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Что делать,
если вы хотите повысить резкость изображения? В этом случае вы можете
использовать фильтр&nbsp;</span><span style='font-size:13.5pt;font-family:Consolas;
color:black'>ImageFilter.SHARPEN</span><span style='font-size:13.5pt;
font-family:"Arial",sans-serif;color:black'>&nbsp;и сравнить результат с
исходным изображением:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>sharp_img
= img.filter(ImageFilter.SHARPEN)<br>
img.crop((300, 300, 500, 500)).show()<br>
sharp_img.crop((300, 300, 500, 500)).show()</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Вы можете
сравнить обрезанную версию обоих изображений, показывающих небольшую часть
здания.</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'><img border=0 width=400 height=200 id="Рисунок 32"
src="PillowKAN.files/image013.jpg" alt=" Изображение с резкостью справа"></span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Изображение
с резкостью справа</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Возможно,
вместо повышения резкости, изображение нужно сгладить. Вы можете добиться
этого, передав&nbsp;</span><span style='font-size:13.5pt;font-family:Consolas;
color:black'>ImageFilter.SMOOTH</span><span style='font-size:13.5pt;font-family:
"Arial",sans-serif;color:black'>&nbsp;в качестве аргумента для&nbsp;</span><span
style='font-size:13.5pt;font-family:Consolas;color:black'>.filter():</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>smooth_img
= img.filter(ImageFilter.SMOOTH)<br>
img.crop((300, 300, 500, 500)).show()<br>
smooth_img.crop((300, 300, 500, 500)).show()</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Ниже вы
можете увидеть исходное изображение слева и сглаженное изображение справа:</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'><img border=0 width=400 height=200 id="Рисунок 31"
src="PillowKAN.files/image014.jpg"
alt="https://habrastorage.org/r/w1560/getpro/habr/upload_files/e2e/a4a/0c5/e2ea4a0c56ac29ad6aa3694a74ce1638.jpg"></span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Разберем
применение сглаженного фильтра в следующем разделе, в котором вы узнаете о
дополнительных фильтрах в модуле ImageFilter. Эти фильтры воздействуют на края
объектов на изображении.</span></p>

<p class=MsoNormal style='margin-top:42.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:18.0pt;font-family:"Arial",sans-serif;color:black'>Обнаружение
границ, приданием им четкости и тиснение</span></p>

<p class=MsoNormal style='margin-top:9.0pt;margin-right:0cm;margin-bottom:0cm;
margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Когда вы
смотрите на изображение, легко определить границы объектов на этом изображении.
Алгоритм также может автоматически обнаруживать края, вызывая выявление границ.</span></p>

<p class=MsoNormal style='margin-top:18.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Модуль
ImageFilter в Pillow имеет предопределенное ядро &#8203;&#8203;для достижения
этой цели. В этом разделе вы снова используете изображения зданий и
конвертируете его в оттенки серого, прежде чем применять фильтр обнаружения
границ. Вы можете продолжить сеанс REPL из прошлого раздела:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:10.0pt;font-family:Consolas;color:black'>img_gray =
img.convert(&quot;L&quot;)<br>
edges = img_gray.filter(ImageFilter.FIND_EDGES)<br>
edges.show()</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'><img border=0 width=606 height=402 id="Рисунок 30"
src="PillowKAN.files/image015.jpg" alt="результат обнаружения границ"></span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>результат
обнаружения границ</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Данный
фильтр идентифицирует границы изображения. Вы можете получить лучший результат,
применив фильтр&nbsp;</span><span style='font-size:13.5pt;font-family:Consolas;
color:black'>ImageFilter.SMOOTH</span><span style='font-size:13.5pt;font-family:
"Arial",sans-serif;color:black'>&nbsp;перед поиском границ:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>img_gray_smooth
= img_gray.filter(ImageFilter.SMOOTH)<br>
edges_smooth = img_gray_smooth.filter(ImageFilter.FIND_EDGES)<br>
edges_smooth.show()</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Изучите
исходное изображение в градациях серого и два результата обнаружения границ
ниже. Версия со сглаживанием перед обнаружением краев показана в самом низу:</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'><img border=0 width=531 height=1057 id="Рисунок 29"
src="PillowKAN.files/image016.jpg"
alt="https://habrastorage.org/r/w1560/getpro/habr/upload_files/b1e/a01/e6a/b1ea01e6a3c6f9fa54a13d26a491e304.jpg"></span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Вы также
можете улучшить границы исходного изображения с помощью фильтра&nbsp;</span><span
style='font-size:13.5pt;font-family:Consolas;color:black'>ImageFilter.EDGE_ENHANCE</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>edge_enhance
= img_gray_smooth.filter(ImageFilter.EDGE_ENHANCE)<br>
edge_enhance.show()</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>В данном
случае используется сглаженная версия изображения в градациях серого для
очерчивания границ. Часть исходного изображения в градациях серого и
изображение с очерченными границами показаны рядом ниже.</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'><img border=0 width=602 height=640 id="Рисунок 28"
src="PillowKAN.files/image017.jpg"
alt="Изображение с очерченными границами находится справа"></span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Изображение
с очерченными границами находится справа</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Еще одним
предопределенным фильтром в&nbsp;</span><span style='font-size:13.5pt;
font-family:Consolas;color:black'>ImageFilter</span><span style='font-size:
13.5pt;font-family:"Arial",sans-serif;color:black'>, который работает с
границами объекта, является&nbsp;</span><span style='font-size:13.5pt;
font-family:Consolas;color:black'>ImageFilter.EMBOSS</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>. Вы можете
передать его в качестве аргумента .filter(), как мы делали с другими фильтрами
в этом разделе:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>emboss =
img_gray_smooth.filter(ImageFilter.EMBOSS)<br>
emboss.show()</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Вы
используете сглаженную версию в градациях серого в качестве отправной точки для
этого фильтра. Ниже представлено рельефное изображение, на котором показан
другой эффект с обработкой границ на изображении:</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'><img border=0 width=622 height=413 id="Рисунок 27"
src="PillowKAN.files/image018.jpg"
alt="https://habrastorage.org/r/w1560/getpro/habr/upload_files/cc8/9a2/fc1/cc89a2fc1894097218ccf52ac592bbf5.jpg"></span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>В этом
разделе вы узнали о нескольких доступных в модуле&nbsp;</span><span
style='font-size:13.5pt;font-family:Consolas;color:black'>ImageFilter</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>&nbsp;фильтрах,
которые можно применять к изображениям. Существуют и другие фильтры. Вы можете
увидеть список всех доступных фильтров в&nbsp;</span><a
href="https://pillow.readthedocs.io/en/stable/reference/ImageFilter.html?highlight=imagefilter#imagefilter-module"
target="_blank"><span style='font-size:13.5pt;font-family:"Arial",sans-serif'>документации
ImageFilter</span></a><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>.</span></p>

<p class=MsoNormal style='margin-top:42.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:18.0pt;font-family:"Arial",sans-serif;color:black'>Сегментация
и наложение изображений. Пример:</span></p>

<p class=MsoNormal style='margin-top:9.0pt;margin-right:0cm;margin-bottom:0cm;
margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>В этом
разделе вы будете использовать файлы изображений с именами cat.jpg и
monastery.jpg, которые вы можете найти в&nbsp;</span><a
href="https://realpython.com/bonus/image-processing-with-the-python-pillow-library-images/"
target="_blank"><span style='font-size:13.5pt;font-family:"Arial",sans-serif'>репозитории</span></a><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>&nbsp;изображений
для этого руководства. Вот два изображения:</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'><img border=0 width=643 height=426
src="PillowKAN.files/image019.png" alt="  - Описание: cat.jpg"></span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>cat.jpg<img
border=0 width=616 height=409 id="Рисунок 25" src="PillowKAN.files/image020.jpg"
alt=monastery.jpg>monastery.jpg</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Вы можете
использовать библиотеку Python Pillow, чтобы извлечь кота из первого
изображения и разместить его на полу монастырского двора. Для этого потребуется
ряд методов обработки изображений.</span></p>

<p class=MsoNormal style='margin-top:42.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:18.0pt;font-family:"Arial",sans-serif;color:black'>Порог
изображения</span></p>

<p class=MsoNormal style='margin-top:9.0pt;margin-right:0cm;margin-bottom:0cm;
margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Начнем
работу с cat.jpg. Сначала нужно будет удалить изображение кошки с фона,
используя методы сегментации изображения. В этом примере сегментируется
изображение, используя методы пороговой обработки. Сначала обрезаем изображение
до меньшего размера, чтобы удалить часть фона. Для данного проекта можно начать
новую сессию REPL для этого проекта:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><b><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:#8959A8'>from</span></b><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'> PIL </span><b><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:#8959A8'>import</span></b><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'> Image<br>
filename_cat = &quot;cat.jpg&quot;<br>
<br>
</span><b><span lang=EN-US style='font-size:10.0pt;font-family:Consolas;
color:#8959A8'>with</span></b><span lang=EN-US style='font-size:10.0pt;
font-family:Consolas;color:black'> Image.open(filename_cat) </span><b><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:#8959A8'>as</span></b><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'> img_cat:<br>
    img_cat.load()<br>
<br>
<br>
img_cat = img_cat.crop((800, 0, 1650, 1281))<br>
img_cat.show()</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Обрезанное
изображение содержит кошку и часть фона, который максимально близок к кошке:</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'><img border=0 width=553 height=834 id="Рисунок 24"
src="PillowKAN.files/image021.jpg"
alt="https://habrastorage.org/r/w1560/getpro/habr/upload_files/164/c58/866/164c588663660549f7d48d519e0c5c53.jpg"></span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Каждый
пиксель цветного изображения представляется в цифровом виде тремя числами,
соответствующими значениям красного, зеленого и синего цвета этого пикселя.
Поиск порогового значения — это процесс преобразования всех пикселей в
максимальное или минимальное значение в зависимости от того, выше или ниже они
определенного числа. Это проще сделать с изображением в градациях серого:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:10.0pt;font-family:Consolas;color:black'>img_cat_gray =
img_cat.convert(&quot;L&quot;)<br>
img_cat_gray.show()<br>
threshold = 100<br>
img_cat_threshold = img_cat_gray.point(<br>
    </span><b><span style='font-size:10.0pt;font-family:Consolas;color:#8959A8'>lambda</span></b><span
style='font-size:10.0pt;font-family:Consolas;color:black'> x: 255 </span><b><span
style='font-size:10.0pt;font-family:Consolas;color:#8959A8'>if</span></b><span
style='font-size:10.0pt;font-family:Consolas;color:black'> x &gt; threshold </span><b><span
style='font-size:10.0pt;font-family:Consolas;color:#8959A8'>else</span></b><span
style='font-size:10.0pt;font-family:Consolas;color:black'> 0<br>
)<br>
img_cat_threshold.show()</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Вы
достигаете порога, вызывая .</span><span style='font-size:13.5pt;font-family:
Consolas;color:black'>point()</span><span style='font-size:13.5pt;font-family:
"Arial",sans-serif;color:black'>&nbsp;для преобразования каждого пикселя в
изображении в градациях серого либо в 255, либо в 0. Преобразование зависит от
того, больше или меньше значение в изображении в градациях серого, чем
пороговое значение. Пороговое значение в этом примере равно 100.</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'><img border=0 width=601 height=453 id="Рисунок 23"
src="PillowKAN.files/image022.jpg"
alt="изображение в градациях серого и результат процесса пороговой обработки"></span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>изображение
в градациях серого и результат процесса пороговой обработки</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>В этом
примере все точки изображения в градациях серого со значением пикселя больше
100 преобразуются в белые, а все остальные пиксели изменяются на черные. Вы
можете изменить чувствительность процесса пороговой обработки, изменив
пороговое значение.</span></p>

<p class=MsoNormal style='margin-top:18.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Пороговое
значение можно использовать для сегментации изображений, когда объект для
сегментации отличается от фона. Вы можете добиться лучших результатов с более
контрастными версиями исходного изображения. В этом примере вы можете добиться
более высокой контрастности, установив порог синего канала исходного
изображения, а не изображения в градациях серого, поскольку доминирующими
цветами фона являются коричневый и зеленый цвета, которые имеют слабую синюю
составляющую. Вы можете извлечь красный, зеленый и синий каналы из цветного
изображения, как мы это делали ранее:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>red,
green, blue = img_cat.split()<br>
red.show()<br>
green.show()<br>
blue.show()</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'><img border=0 width=643 height=324 id="Рисунок 22"
src="PillowKAN.files/image023.jpg"
alt="Красный, зеленый и синий режимы показаны слева направо. Все три отображаются как изображения в градациях серого"></span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Красный,
зеленый и синий режимы показаны слева направо. Все три отображаются как
изображения в градациях серого</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Синий режим
имеет более высокий контраст между пикселями, представляющими кошку, и
пикселями, представляющими фон. Вы можете использовать изображение синего
режима для порога:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:10.0pt;font-family:Consolas;color:black'>threshold = 57<br>
img_cat_threshold = blue.point(</span><b><span style='font-size:10.0pt;
font-family:Consolas;color:#8959A8'>lambda</span></b><span style='font-size:
10.0pt;font-family:Consolas;color:black'> x: 255 </span><b><span
style='font-size:10.0pt;font-family:Consolas;color:#8959A8'>if</span></b><span
style='font-size:10.0pt;font-family:Consolas;color:black'> x &gt; threshold </span><b><span
style='font-size:10.0pt;font-family:Consolas;color:#8959A8'>else</span></b><span
style='font-size:10.0pt;font-family:Consolas;color:black'> 0)<br>
img_cat_threshold = img_cat_threshold.convert(&quot;1&quot;)<br>
img_cat_threshold.show()</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>В этом
примере вы используете пороговое значение 57. Вы также конвертируете
изображение в двоичный режим, используя «1» в качестве аргумента для
.convert(). Пиксели в бинарном изображении могут иметь только значения 0 или 1.</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal'><b><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>Примечание.</span></b><span style='font-size:13.5pt;font-family:
"Arial",sans-serif;color:black'>&nbsp;При работе с определенными форматами
изображений, такими как JPEG, которые основаны на сжатии с потерями,
изображения могут немного отличаться в зависимости от того, какие декодеры JPEG
вы используете. Различные операционные системы часто поставляются со своими
декодерами JPEG по умолчанию. Поэтому результаты, которые вы получаете при
обработке изображений, могут различаться в зависимости от используемой
операционной системы и декодера JPEG.</span></p>

<p class=MsoNormal style='margin-top:18.0pt;line-height:normal'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Возможно,
вам придется немного скорректировать пороговое значение, если ваши результаты
не совпадают с показанными в этом руководстве.</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'><img border=0 width=686 height=887
src="PillowKAN.files/image024.png"
alt="  - Описание: результат пороговой обработки"></span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>результат
пороговой обработки</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Вы можете
узнать кошку на этом черно-белом изображении. Однако, наша цель - иметь
изображение, в котором все пиксели, соответствующие кошке, белые, а все
остальные пиксели — черные. На данном изображении все еще есть черные области в
области, соответствующей кошке, например, где находятся глаза, нос и рот, а
также есть белые пиксели в других местах изображения.</span></p>

<p class=MsoNormal style='margin-top:18.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Вы можете
использовать методы обработки изображения, называемые размытием и расширением,
чтобы создать лучший образ, представляющий кошку. Вы узнаете об этих двух
методах в следующем разделе.</span></p>

<p class=MsoNormal style='margin-top:42.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:18.0pt;font-family:"Arial",sans-serif;color:black'>Сжатие(erosion)
и расширение(dilation)</span></p>

<p class=MsoNormal style='margin-top:9.0pt;margin-right:0cm;margin-bottom:0cm;
margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Вы
загрузить файл изображения с именем dot_and_hole.jpg из репозитория,
представленного в первых главах туториала.</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'><img border=0 width=311 height=311
src="PillowKAN.files/image025.png" alt="  - Описание: dot_and_hole.jpg"></span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>dot_and_hole.jpg</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>В левой
части этого бинарного изображения показана белая точка на черном фоне, а в
правой части — черная дыра на сплошном белом участке.</span></p>

<p class=MsoNormal style='margin-top:18.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Сжатие(erosion)
— это процесс удаления белых пикселей с границ изображения. Вы можете добиться
этого в двоичном изображении, используя&nbsp;</span><span style='font-size:
13.5pt;font-family:Consolas;color:black'>ImageFilter.MinFilter(3)</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>&nbsp;в
качестве аргумента для метода&nbsp;</span><span style='font-size:13.5pt;
font-family:Consolas;color:black'>.filter()</span><span style='font-size:13.5pt;
font-family:"Arial",sans-serif;color:black'>. Этот фильтр заменяет значение
пикселя минимальным значением девяти пикселей в массиве 3x3, центрированном
вокруг пикселя. В бинарном изображении это означает, что пиксель будет иметь
нулевое значение, если любой из его соседних пикселей равен нулю. Вы можете
увидеть эффект эрозии, применив&nbsp;</span><span style='font-size:13.5pt;
font-family:Consolas;color:black'>ImageFilter.MinFilter(3)</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>&nbsp;несколько
раз к изображению dot_and_hole.jpg. Вам следует продолжить тот же сеанс REPL,
что и в предыдущем разделе:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>from PIL
import ImageFilter</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>filename =
&quot;dot_and_hole.jpg&quot;</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>with
Image.open(filename) as img:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>   
img.load()</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>for _ in
range(3):</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>    img =
img.filter(ImageFilter.MinFilter(3))</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:10.0pt;font-family:Consolas;color:black'>img.show()</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Мы
применяем фильтр три раза, используя цикл for. Этот код дает следующий
результат:</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><img border=0 width=242 height=241 id="Рисунок 60"
src="PillowKAN.files/image026.jpg"><span style='font-size:13.5pt;font-family:
"Arial",sans-serif;color:black'> </span><img width=200 height=200
src="PillowKAN.files/image027.png"
alt="https://habrastorage.org/getpro/habr/upload_files/91a/e62/342/91ae62342e17b032f2cfff6160663d9d.webp"></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Точка
уменьшилась, но отверстие увеличилось в результате эрозии. Дилатация – процесс,
противоположный эрозии. Белые пиксели добавляются к границам бинарного
изображения. Вы можете добиться расширения с помощью&nbsp;</span><span
style='font-size:13.5pt;font-family:Consolas;color:black'>ImageFilter.MaxFilter(3),</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>&nbsp;который
преобразует пиксель в белый, если любой из его соседей белый. Вы можете
применить расширение к тому же изображению, содержащему точку и отверстие,
которое вы можете открыть и снова загрузить:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><b><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:#8959A8'>with</span></b><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>
Image.open(filename) </span><b><span lang=EN-US style='font-size:10.0pt;
font-family:Consolas;color:#8959A8'>as</span></b><span lang=EN-US
style='font-size:10.0pt;font-family:Consolas;color:black'> img:<br>
    img.load()<br>
<br>
<br>
</span><b><span lang=EN-US style='font-size:10.0pt;font-family:Consolas;
color:#8959A8'>for</span></b><span lang=EN-US style='font-size:10.0pt;
font-family:Consolas;color:black'> _ </span><b><span lang=EN-US
style='font-size:10.0pt;font-family:Consolas;color:#8959A8'>in</span></b><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'> range(3):<br>
    img = img.filter(ImageFilter.MaxFilter(3))<br>
<br>
<br>
img.show()</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><img border=0 width=330 height=330 id="Рисунок 61"
src="PillowKAN.files/image028.jpg"><span style='font-size:13.5pt;font-family:
"Arial",sans-serif;color:black'> </span><span style='font-size:13.5pt;
font-family:"Arial",sans-serif;color:black'>теперь точка стала больше, а дырка
уменьшилась</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Вы можете
использовать эрозию и расширение вместе, чтобы заполнить дыры и удалить мелкие
объекты из бинарного изображения. Используя изображение с точкой и отверстием,
вы можете выполнить десять циклов эрозии, чтобы удалить точку, а затем десять
циклов расширения, чтобы восстановить исходный размер отверстия:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><b><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:#8959A8'>with</span></b><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>
Image.open(filename) </span><b><span lang=EN-US style='font-size:10.0pt;
font-family:Consolas;color:#8959A8'>as</span></b><span lang=EN-US
style='font-size:10.0pt;font-family:Consolas;color:black'> img:<br>
    img.load()<br>
<br>
<br>
</span><b><span lang=EN-US style='font-size:10.0pt;font-family:Consolas;
color:#8959A8'>for</span></b><span lang=EN-US style='font-size:10.0pt;
font-family:Consolas;color:black'> _ </span><b><span lang=EN-US
style='font-size:10.0pt;font-family:Consolas;color:#8959A8'>in</span></b><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>
range(10):<br>
    img = img.filter(ImageFilter.MinFilter(3))<br>
<br>
<br>
img.show()<br>
<br>
</span><b><span lang=EN-US style='font-size:10.0pt;font-family:Consolas;
color:#8959A8'>for</span></b><span lang=EN-US style='font-size:10.0pt;
font-family:Consolas;color:black'> _ </span><b><span lang=EN-US
style='font-size:10.0pt;font-family:Consolas;color:#8959A8'>in</span></b><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>
range(10):<br>
    img = img.filter(ImageFilter.MaxFilter(3))<br>
<br>
<br>
img.show()</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Вы
выполняете десять циклов эрозии с помощью первого цикла for. Изображение на
этом этапе выглядит следующим образом:</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><img border=0 width=353 height=354 id="Рисунок 62"
src="PillowKAN.files/image029.jpg"><span style='font-size:13.5pt;font-family:
"Arial",sans-serif;color:black'> </span><img width=200 height=200
src="PillowKAN.files/image027.png"
alt="https://habrastorage.org/getpro/habr/upload_files/8da/e9f/6bd/8dae9f6bd56435cdf9ff071ad96ebe40.webp"></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Точка
исчезла, а отверстие больше, чем было на исходном изображении. Второй цикл for
выполняет десять циклов расширения, которые возвращают отверстие к исходному
размеру:</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><img border=0 width=359 height=362 id="Рисунок 63"
src="PillowKAN.files/image030.jpg"><span style='font-size:13.5pt;font-family:
"Arial",sans-serif;color:black'> </span><img width=200 height=200
src="PillowKAN.files/image027.png"
alt="https://habrastorage.org/getpro/habr/upload_files/319/496/f51/319496f512afa2d727f8354fe62fdc2f.webp"></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Однако
точки больше нет на изображении. Сжатие и расширение изменили изображение,
чтобы сохранить отверстие, но удалить точку. Количество необходимых сжатий и
расширений зависит от изображения и от того, чего вы хотите достичь. Часто вам
нужно будет найти правильную комбинацию методом проб и ошибок. Вы можете
определить функции для выполнения нескольких циклов сжатия и расширения:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><b><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:#8959A8'>def</span></b><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>
erode(cycles, image):<br>
    </span><b><span lang=EN-US style='font-size:10.0pt;font-family:Consolas;
color:#8959A8'>for</span></b><span lang=EN-US style='font-size:10.0pt;
font-family:Consolas;color:black'> _ </span><b><span lang=EN-US
style='font-size:10.0pt;font-family:Consolas;color:#8959A8'>in</span></b><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>
range(cycles):<br>
         image = image.filter(ImageFilter.MinFilter(3))<br>
    </span><b><span lang=EN-US style='font-size:10.0pt;font-family:Consolas;
color:#8959A8'>return</span></b><span lang=EN-US style='font-size:10.0pt;
font-family:Consolas;color:black'> image<br>
<br>
<br>
</span><b><span lang=EN-US style='font-size:10.0pt;font-family:Consolas;
color:#8959A8'>def</span></b><span lang=EN-US style='font-size:10.0pt;
font-family:Consolas;color:black'> dilate(cycles, image):<br>
    </span><b><span lang=EN-US style='font-size:10.0pt;font-family:Consolas;
color:#8959A8'>for</span></b><span lang=EN-US style='font-size:10.0pt;
font-family:Consolas;color:black'> _ </span><b><span lang=EN-US
style='font-size:10.0pt;font-family:Consolas;color:#8959A8'>in</span></b><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>
range(cycles):<br>
         image = image.filter(ImageFilter.MaxFilter(3))<br>
    </span><b><span lang=EN-US style='font-size:10.0pt;font-family:Consolas;
color:#8959A8'>return</span></b><span lang=EN-US style='font-size:10.0pt;
font-family:Consolas;color:black'> image</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Эти функции
упрощают эксперименты с сжатием и расширением изображения. Вы будете
использовать эти функции в следующем разделе, продолжая работать над помещением
кота в монастырь.</span></p>

<p class=MsoNormal style='margin-top:42.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:18.0pt;font-family:"Arial",sans-serif;color:black'>Сегментация
изображения с использованием порогового значения</span></p>

<p class=MsoNormal style='margin-top:9.0pt;margin-right:0cm;margin-bottom:0cm;
margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Вы можете
использовать последовательность сжатий и расширений на пороговом изображении,
которое вы получили ранее, чтобы удалить части образа, которые не представляют
кошку, и заполнить любые пробелы в области, содержащей кошку. После того, как
вы поэкспериментировали со сжатием и расширением, вы сможете использовать обоснованные
предположения в процессе проб и ошибок, чтобы найти наилучшее сочетание сжатий
и расширений для получения идеального образа.</span></p>

<p class=MsoNormal style='margin-top:18.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Начиная с
изображения img_cat_threshold, которое вы получили ранее, вы можете начать с
серии сжатий, чтобы удалить белые пиксели, представляющие фон исходного
изображения. Следует продолжить работу в том же сеансе REPL, что и в предыдущих
разделах:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>step_1 =
erode(12, img_cat_threshold)<br>
step_1.show()</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Новое
пороговое изображение больше не содержит белых пикселей на фоне изображения:</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><img border=0 width=610 height=920 id="Рисунок 64"
src="PillowKAN.files/image031.png"><span style='font-size:13.5pt;font-family:
"Arial",sans-serif;color:black'> </span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Однако
оставшийся образ меньше, чем общий контур кота, и внутри нее есть отверстия и
промежутки. Вы можете выполнить расширение, чтобы заполнить пробелы:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:10.0pt;font-family:Consolas;color:black'>step_2 = dilate(58,
step_1)<br>
step_2.show()</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Пятьдесят
восемь циклов расширения заполнили все отверстия в образе, чтобы получить
следующее изображение: </span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><img
border=0 width=574 height=695 id="Рисунок 65" src="PillowKAN.files/image032.jpg"><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'> </span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>&nbsp;</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Однако этот
образ слишком велик. Таким образом, вы можете закончить процесс серией сжатий:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>cat_mask =
erode(45, step_2)<br>
cat_mask.show()</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>В
результате получится образ, который можно использовать для сегментации
изображения кота:</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><img border=0 width=474 height=700 id="Рисунок 66"
src="PillowKAN.files/image033.jpg"><span style='font-size:13.5pt;font-family:
"Arial",sans-serif;color:black'> </span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>&nbsp;</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Вы можете
избежать острых краев бинарного образа, размыв этот образ. Сначала вам нужно
преобразовать его из двоичного изображения в изображение в градациях серого:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>cat_mask =
cat_mask.convert(&quot;L&quot;)<br>
cat_mask = cat_mask.filter(ImageFilter.BoxBlur(20))<br>
cat_mask.show()</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><img border=0 width=454 height=667 id="Рисунок 67"
src="PillowKAN.files/image034.jpg"><span style='font-size:13.5pt;font-family:
"Arial",sans-serif;color:black'> </span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>Фильтр BoxBlur() возвращает следующий образ</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Образ
теперь выглядит как кошка! Теперь вы готовы извлечь изображение кота из фона:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>blank =
img_cat.point(</span><b><span lang=EN-US style='font-size:10.0pt;font-family:
Consolas;color:#8959A8'>lambda</span></b><span lang=EN-US style='font-size:
10.0pt;font-family:Consolas;color:black'> _: 0)<br>
cat_segmented = Image.composite(img_cat, blank, cat_mask)<br>
cat_segmented.show()</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Сначала вы
создаете пустой образ того же размера, что и img_cat. Вы создаете новый объект
изображения из&nbsp;</span><span style='font-size:13.5pt;font-family:Consolas;
color:black'>img_cat</span><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>, используя&nbsp;</span><span style='font-size:13.5pt;font-family:
Consolas;color:black'>.point()</span><span style='font-size:13.5pt;font-family:
"Arial",sans-serif;color:black'>&nbsp;и устанавливаете все значения равными
нулю. Затем вы используете функцию&nbsp;</span><span style='font-size:13.5pt;
font-family:Consolas;color:black'>Composite()</span><span style='font-size:
13.5pt;font-family:"Arial",sans-serif;color:black'>&nbsp;в PIL.Image для
создания изображения, содержащую параметры&nbsp;</span><span style='font-size:
13.5pt;font-family:Consolas;color:black'>img_cat</span><span style='font-size:
13.5pt;font-family:"Arial",sans-serif;color:black'>,&nbsp;</span><span
style='font-size:13.5pt;font-family:Consolas;color:black'>blank</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>,</span><span
style='font-size:13.5pt;font-family:Consolas;color:black'>cat_mask</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>, чтобы
определить, какие части каждого изображения используются. Композитное
изображение показано ниже:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>&nbsp;</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><img border=0 width=450 height=664 id="Рисунок 68"
src="PillowKAN.files/image035.jpg"><span style='font-size:13.5pt;font-family:
"Arial",sans-serif;color:black'> </span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>Композитное изображение</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Вы сегментировали
изображение кота и выделили его из фона.</span></p>

<p class=MsoNormal style='margin-top:42.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:18.0pt;font-family:"Arial",sans-serif;color:black'>Наложение
изображений с использованием Image.paste()</span></p>

<p class=MsoNormal style='margin-top:9.0pt;margin-right:0cm;margin-bottom:0cm;
margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Вы можете
пойти еще дальше и вставить сегментированное изображение кота в изображение
монастырского двора из репозитория изображений для этого урока:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>filename_monastery
= &quot;monastery.jpg&quot;<br>
</span><b><span lang=EN-US style='font-size:10.0pt;font-family:Consolas;
color:#8959A8'>with</span></b><span lang=EN-US style='font-size:10.0pt;
font-family:Consolas;color:black'> Image.open(filename_monastery) </span><b><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:#8959A8'>as</span></b><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>
img_monastery:<br>
    img_monastery.load()<br>
<br>
img_monastery.paste(<br>
    img_cat.resize((img_cat.width // 5, img_cat.height // 5)),<br>
    (1300, 750),<br>
    cat_mask.resize((cat_mask.width // 5, cat_mask.height // 5)),<br>
)<br>
<br>
img_monastery.show()</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Вы
использовали .</span><span style='font-size:13.5pt;font-family:Consolas;
color:black'>paste()</span><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>&nbsp;для вставки изображения в другое. Этот метод можно
использовать с тремя аргументами:</span></p>

<ul style='margin-top:0cm' type=disc>
 <li class=MsoNormal style='color:black;margin-bottom:0cm;margin-bottom:.0001pt;
     line-height:normal;background:white'><span style='font-size:13.5pt;
     font-family:"Arial",sans-serif'>Первый аргумент — это&nbsp;<b>изображение</b>,
     которое вы хотите вставить. Вы изменяете размер изображения до одной пятой
     его размера, используя оператор целочисленного деления (//).</span></li>
 <li class=MsoNormal style='color:black;margin-bottom:0cm;margin-bottom:.0001pt;
     line-height:normal;background:white'><span style='font-size:13.5pt;
     font-family:"Arial",sans-serif'>Второй аргумент — это&nbsp;<b>место</b>&nbsp;на
     основном изображении, куда вы хотите вставить второе изображение. Кортеж
     включает в себя координаты в основном изображении, где вы хотите поместить
     верхний левый угол изображения, которое вы вставляете.</span></li>
 <li class=MsoNormal style='color:black;margin-bottom:0cm;margin-bottom:.0001pt;
     line-height:normal;background:white'><span style='font-size:13.5pt;
     font-family:"Arial",sans-serif'>Третий аргумент предоставляет
     образ(маску), которую вы хотите использовать, если не хотите вставлять все
     изображение.</span></li>
</ul>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>Вы использовали образ, полученный в процессе пороговой обработки,
эрозии и расширения, чтобы вставить кошку без фона. На выходе получается
следующее изображение:</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'><img border=0 width=647 height=431 id="Рисунок 10"
src="PillowKAN.files/image036.jpg" alt="кошка в монастыре после всех операций"></span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>кошка в
монастыре после всех операций</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Вы отделили
кошку от одного изображения и поместили ее на другое изображение, чтобы
показать кошку, спокойно сидящую во дворе монастыря, а не в поле, где она
сидела на исходном изображении.</span></p>

<p class=MsoNormal style='margin-top:42.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:18.0pt;font-family:"Arial",sans-serif;color:black'>Создание
водяного знака</span></p>

<p class=MsoNormal style='margin-top:9.0pt;margin-right:0cm;margin-bottom:0cm;
margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Ваша
последняя задача в этом примере — добавить логотип Real Python в качестве
водяного знака на изображение. Вы можете получить файл изображения с логотипом
Real Python из&nbsp;</span><a
href="https://realpython.com/bonus/image-processing-with-the-python-pillow-library-images/"
target="_blank"><span style='font-size:13.5pt;font-family:"Arial",sans-serif'>репозитория</span></a><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>. Вы должны
продолжить работу в том же сеансе REPL:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:10.0pt;font-family:Consolas;color:black'>logo =
&quot;realpython-logo.png&quot;<br>
</span><b><span style='font-size:10.0pt;font-family:Consolas;color:#8959A8'>with</span></b><span
style='font-size:10.0pt;font-family:Consolas;color:black'> Image.open(logo) </span><b><span
style='font-size:10.0pt;font-family:Consolas;color:#8959A8'>as</span></b><span
style='font-size:10.0pt;font-family:Consolas;color:black'> img_logo:<br>
    img_logo.load()<br>
<br>
<br>
img_logo = Image.open(logo)<br>
img_logo.show()</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><img border=0 width=591 height=598 id="Рисунок 69"
src="PillowKAN.files/image037.png"><span style='font-size:13.5pt;font-family:
"Arial",sans-serif;color:black'> </span><span style='font-size:13.5pt;
font-family:"Arial",sans-serif;color:black'>полноразмерный логотип в цвете</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Вы можете
изменить изображение на оттенки серого и установить пороговое значение с
помощью&nbsp;</span><span style='font-size:13.5pt;font-family:Consolas;
color:black'>.point()</span><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>, чтобы преобразовать его в черно-белое изображение. Вы также
уменьшаете его размер и преобразуете в контурное изображение:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:10.0pt;font-family:Consolas;color:black'>img_logo =
img_logo.convert(&quot;L&quot;)<br>
threshold = 50<br>
img_logo = img_logo.point(</span><b><span style='font-size:10.0pt;font-family:
Consolas;color:#8959A8'>lambda</span></b><span style='font-size:10.0pt;
font-family:Consolas;color:black'> x: 255 </span><b><span style='font-size:
10.0pt;font-family:Consolas;color:#8959A8'>if</span></b><span style='font-size:
10.0pt;font-family:Consolas;color:black'> x &gt; threshold </span><b><span
style='font-size:10.0pt;font-family:Consolas;color:#8959A8'>else</span></b><span
style='font-size:10.0pt;font-family:Consolas;color:black'> 0)<br>
img_logo = img_logo.resize(<br>
    (img_logo.width // 2, img_logo.height // 2)<br>
)<br>
img_logo = img_logo.filter(ImageFilter.CONTOUR)<br>
img_logo.show()</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>На выходе
показан контур логотипа Real Python. Контур идеально подходит для использования
в качестве водяного знака на нашем изображении:</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><img border=0 width=399 height=403 id="Рисунок 70"
src="PillowKAN.files/image038.jpg"><span style='font-size:13.5pt;font-family:
"Arial",sans-serif;color:black'> </span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>контур логотипа</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Чтобы
использовать это в качестве водяного знака, вам нужно поменять местами цвета,
чтобы фон был черным, а контур, который вы хотите сохранить, был белым. Вы
можете добиться этого, снова используя&nbsp;</span><span style='font-size:13.5pt;
font-family:Consolas;color:black'>.point()</span><span style='font-size:13.5pt;
font-family:"Arial",sans-serif;color:black'>:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:10.0pt;font-family:Consolas;color:black'>img_logo =
img_logo.point(</span><b><span style='font-size:10.0pt;font-family:Consolas;
color:#8959A8'>lambda</span></b><span style='font-size:10.0pt;font-family:Consolas;
color:black'> x: 0 </span><b><span style='font-size:10.0pt;font-family:Consolas;
color:#8959A8'>if</span></b><span style='font-size:10.0pt;font-family:Consolas;
color:black'> x == 255 </span><b><span style='font-size:10.0pt;font-family:
Consolas;color:#8959A8'>else</span></b><span style='font-size:10.0pt;
font-family:Consolas;color:black'> 255)<br>
img_logo.show()</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Вы
преобразовали пиксели со значением 255 и присвоили им значение 0, преобразовав
их из белых в черные пиксели. Вы оставляете оставшиеся пиксели белыми. Логотип
с преобразованным контуром показан ниже:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><img
border=0 width=624 height=629 id="Рисунок 71" src="PillowKAN.files/image039.jpg"></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>логотип с пребразованным контуром</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Ваш
последний шаг — наложить этот контур на изображение кота, сидящего во дворе
монастыря. Вы можете снова использовать .</span><span style='font-size:13.5pt;
font-family:Consolas;color:black'>paste()</span><span style='font-size:13.5pt;
font-family:"Arial",sans-serif;color:black'>:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:10.0pt;font-family:Consolas;color:black'>img_monastery.paste(img_logo,
(480, 160), img_logo)<br>
img_monastery.show()</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Первый
аргумент в&nbsp;</span><span style='font-size:13.5pt;font-family:Consolas;
color:black'>.paste()</span><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>&nbsp;указывает изображение, которое вы хотите вставить, а третий
аргумент представляет образ(маску). В данном случае вы используете то же
изображение в качестве маски, потому что это бинарное изображение. Второй
аргумент предоставляет верхние левые координаты области, куда вы хотите
вставить изображение. Итоговый вариант теперь содержит водяной знак Real
Python:</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'><img border=0 width=627 height=417 id="Рисунок 6"
src="PillowKAN.files/image040.jpg" alt="итоговое изображение с логотипом"></span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>итоговое
изображение с логотипом</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Водяной
знак имеет прямоугольный контур, что является результатом контурного фильтра,
использованный ранее. Если вы хотите удалить этот контур, вы можете обрезать
изображение с помощью&nbsp;</span><span style='font-size:13.5pt;font-family:
Consolas;color:black'>.crop()</span><span style='font-size:13.5pt;font-family:
"Arial",sans-serif;color:black'>. Это упражнение вы можете попробовать
самостоятельно.</span></p>

<p class=MsoNormal style='margin-top:42.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:18.0pt;font-family:"Arial",sans-serif;color:black'>Операции с
изображениями с помощью NumPy и Pillow</span></p>

<p class=MsoNormal style='margin-top:9.0pt;margin-right:0cm;margin-bottom:0cm;
margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Pillow
имеет обширный выбор встроенных функций и фильтров. Однако бывают случаи, когда
нужно пойти дальше и оперировать изображениями за пределами функций, которые
уже доступны в Pillow.</span></p>

<p class=MsoNormal style='margin-top:18.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Вы можете
дальше манипулировать изображением с помощью NumPy. NumPy — очень популярная
библиотека Python для работы с числовыми массивами, и это идеальный инструмент
для использования с Pillow. Узнать</span><span style='font-size:13.5pt;
font-family:"Arial",sans-serif;color:black'> </span><span style='font-size:
13.5pt;font-family:"Arial",sans-serif;color:black'>больше</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'> </span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>о</span><span
lang=EN-US style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>
NumPy </span><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>можно</span><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'> </span><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>в</span><span lang=EN-US style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>&nbsp;</span><a href="https://realpython.com/numpy-tutorial/"
target="_blank"><span lang=EN-US style='font-size:13.5pt;font-family:"Arial",sans-serif'>NumPy
Tutorial: Your First Steps Into Data Science in Python</span></a><span
lang=EN-US style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>.</span></p>

<p class=MsoNormal style='margin-top:18.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Когда вы
конвертируете изображение в массив NumPy, вы можете выполнять любые необходимые
преобразования непосредственно с пикселями в массиве. После завершения
обработки в NumPy вы можете преобразовать массив обратно в объект изображения с
помощью Pillow. Необходимо установить NumPy для этого раздела:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:10.0pt;font-family:Consolas;color:black'>python -m pip install
numpy</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Теперь,
когда вы установили NumPy, вы готовы использовать Pillow и NumPy, чтобы
определить разницу между двумя изображениями.</span></p>

<p class=MsoNormal style='margin-top:42.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:18.0pt;font-family:"Arial",sans-serif;color:black'>Использование
NumPy для вычитания изображений друг из друга (поиск разницы)</span></p>

<p class=MsoNormal style='margin-top:9.0pt;margin-right:0cm;margin-bottom:0cm;
margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Посмотрите,
сможете ли вы найти различия между следующими двумя изображениями:</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><img border=0 width=624 height=281 id="Рисунок 72"
src="PillowKAN.files/image041.jpg"><span style='font-size:13.5pt;font-family:
"Arial",sans-serif;color:black'> </span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>&nbsp;</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Это не
сложно! Однако вы решаете схитрить и написать программу на Python, которая
решит головоломку за вас. Вы можете загрузить файлы изображений house_left.jpg
и house_right.jpg из&nbsp;</span><a
href="https://realpython.com/bonus/image-processing-with-the-python-pillow-library-images/"
target="_blank"><span style='font-size:13.5pt;font-family:"Arial",sans-serif'>репозитория</span></a><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>.</span></p>

<p class=MsoNormal style='margin-top:18.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Ваш первый
шаг — прочитать изображения с помощью Pillow и преобразовать их в массивы
NumPy:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>&gt;&gt;&gt;
</span><b><span lang=EN-US style='font-size:10.0pt;font-family:Consolas;
color:#8959A8'>import</span></b><span lang=EN-US style='font-size:10.0pt;
font-family:Consolas;color:black'> numpy </span><b><span lang=EN-US
style='font-size:10.0pt;font-family:Consolas;color:#8959A8'>as</span></b><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'> np<br>
&gt;&gt;&gt; </span><b><span lang=EN-US style='font-size:10.0pt;font-family:
Consolas;color:#8959A8'>from</span></b><span lang=EN-US style='font-size:10.0pt;
font-family:Consolas;color:black'> PIL </span><b><span lang=EN-US
style='font-size:10.0pt;font-family:Consolas;color:#8959A8'>import</span></b><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'> Image<br>
<br>
&gt;&gt;&gt; </span><b><span lang=EN-US style='font-size:10.0pt;font-family:
Consolas;color:#8959A8'>with</span></b><span lang=EN-US style='font-size:10.0pt;
font-family:Consolas;color:black'> Image.open(&quot;house_left.jpg&quot;) </span><b><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:#8959A8'>as</span></b><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'> left:<br>
...     left.load()<br>
...<br>
&gt;&gt;&gt; </span><b><span lang=EN-US style='font-size:10.0pt;font-family:
Consolas;color:#8959A8'>with</span></b><span lang=EN-US style='font-size:10.0pt;
font-family:Consolas;color:black'> Image.open(&quot;house_right.jpg&quot;) </span><b><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:#8959A8'>as</span></b><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'> right:<br>
...     right.load()<br>
...<br>
<br>
&gt;&gt;&gt; left_array = np.asarray(left)<br>
&gt;&gt;&gt; right_array = np.asarray(right)<br>
<br>
&gt;&gt;&gt; type(left_array)<br>
&lt;</span><b><span lang=EN-US style='font-size:10.0pt;font-family:Consolas;
color:#8959A8'>class</span></b><span lang=EN-US style='font-size:10.0pt;
font-family:Consolas;color:black'> 'numpy.ndarray'&gt;<br>
&gt;&gt;&gt; type(right_array)<br>
&lt;</span><b><span lang=EN-US style='font-size:10.0pt;font-family:Consolas;
color:#8959A8'>class</span></b><span lang=EN-US style='font-size:10.0pt;
font-family:Consolas;color:black'> 'numpy.ndarray'&gt;</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Поскольку&nbsp;</span><span
style='font-size:13.5pt;font-family:Consolas;color:black'>left_array</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>&nbsp;и&nbsp;</span><span
style='font-size:13.5pt;font-family:Consolas;color:black'>right_array</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>&nbsp;являются
объектами типа numpy.ndarray, вы можете оперировать ими, используя все
инструменты, доступные в NumPy. Можно вычесть один массив из другого, чтобы
показать пиксели, которые различаются между двумя изображениями:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>&gt;&gt;&gt;
difference_array =  right_array - left_array<br>
&gt;&gt;&gt; type(difference_array)<br>
&lt;</span><b><span lang=EN-US style='font-size:10.0pt;font-family:Consolas;
color:#8959A8'>class</span></b><span lang=EN-US style='font-size:10.0pt;
font-family:Consolas;color:black'> 'numpy.ndarray'&gt;</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Когда вы
вычитаете массив из другого массива того же размера, в результате получается
еще один массив той же формы, что и исходные массивы. Вы можете преобразовать
этот массив в изображение, используя&nbsp;</span><span style='font-size:13.5pt;
font-family:Consolas;color:black'>Image.fromarray()</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>&nbsp;в
Pillow:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>difference
= Image.fromarray(difference_array)<br>
difference.show()</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Результатом
вычитания одного массива NumPy из другого и преобразования в Pilllow Image
является разностное изображение, показанное ниже:</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><img border=0 width=509 height=427 id="Рисунок 73"
src="PillowKAN.files/image042.jpg"><span style='font-size:13.5pt;font-family:
"Arial",sans-serif;color:black'> </span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>разница между картинками</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Разностное
изображение показывает только три области исходного изображения. Эти области
подчеркивают различия между двумя изображениями. Вы также можете увидеть
некоторый шум вокруг облака и забора из-за небольших изменений в исходном
сжатии JPEG в области, окружающей эти объекты.</span></p>

<p class=MsoNormal style='margin-top:42.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:18.0pt;font-family:"Arial",sans-serif;color:black'>Использование
NumPy для создания изображений</span></p>

<p class=MsoNormal style='margin-top:9.0pt;margin-right:0cm;margin-bottom:0cm;
margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Вы можете
пойти дальше и создавать объкты с нуля, используя NumPy и Pillow. Вы можете
начать с создания изображения в градациях серого. В этом примере вы создадите
простое изображение, содержащее квадрат, но таким же образом вы можете создать
более сложные изображения:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>&gt;&gt;&gt;
</span><b><span lang=EN-US style='font-size:10.0pt;font-family:Consolas;
color:#8959A8'>import</span></b><span lang=EN-US style='font-size:10.0pt;
font-family:Consolas;color:black'> numpy </span><b><span lang=EN-US
style='font-size:10.0pt;font-family:Consolas;color:#8959A8'>as</span></b><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'> np<br>
&gt;&gt;&gt; </span><b><span lang=EN-US style='font-size:10.0pt;font-family:
Consolas;color:#8959A8'>from</span></b><span lang=EN-US style='font-size:10.0pt;
font-family:Consolas;color:black'> PIL </span><b><span lang=EN-US
style='font-size:10.0pt;font-family:Consolas;color:#8959A8'>import</span></b><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'> Image<br>
<br>
&gt;&gt;&gt; square = np.zeros((600, 600))<br>
&gt;&gt;&gt; square[200:400, 200:400] = 255<br>
<br>
&gt;&gt;&gt; square_img = Image.fromarray(square)<br>
&gt;&gt;&gt; square_img<br>
&lt;PIL.Image.Image image mode=F size=600x600 at 0x7FC7D8541F70&gt;<br>
<br>
&gt;&gt;&gt; square_img.show()</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Вы создаете
массив размером 600x600, содержащий везде нули. Затем устанавливаете значение
набора пикселей в центре массива равным 255.</span></p>

<p class=MsoNormal style='margin-top:18.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Вы можете
индексировать массивы NumPy, используя как строки, так и столбцы. В этом
примере первый срез, 200:400, представляет строки с 200 по 399. Второй срез,
200:400, следующий за запятой, представляет столбцы с 200 по 399.</span></p>

<p class=MsoNormal style='margin-top:18.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Также можно
использовать&nbsp;</span><span style='font-size:13.5pt;font-family:Consolas;
color:black'>Image.fromarray()</span><span style='font-size:13.5pt;font-family:
"Arial",sans-serif;color:black'>&nbsp;для преобразования массива NumPy в объект
типа Image. Вывод кода выше показан ниже:</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><img border=0 width=624 height=623 id="Рисунок 74"
src="PillowKAN.files/image043.jpg"><span style='font-size:13.5pt;font-family:
"Arial",sans-serif;color:black'> </span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>Создание объекта с нуля</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Вы создали
изображение в градациях серого, содержащее квадрат. Режим изображения выводится
автоматически, когда вы используете Image</span><span style='font-size:13.5pt;
font-family:Consolas;color:black'>.fromarray()</span><span style='font-size:
13.5pt;font-family:"Arial",sans-serif;color:black'>. В этом случае используется
режим «F», который соответствует изображению с 32-битными пикселями с плавающей
запятой. Вы можете преобразовать это в более простое изображение в градациях
серого с 8-битными пикселями:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>square_img
= square_img.convert(&quot;L&quot;)</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Вы также
можете пойти дальше и создать цветное изображение. Повторим описанный выше
процесс, чтобы создать три изображения, одно из которых соответствует красному
каналу, другое — зеленому, а последнее — синему каналу:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>red =
np.zeros((600, 600))<br>
green = np.zeros((600, 600))<br>
blue = np.zeros((600, 600))<br>
red[150:350, 150:350] = 255<br>
green[200:400, 200:400] = 255<br>
blue[250:450, 250:450] = 255<br>
<br>
red_img = Image.fromarray(red).convert(&quot;L&quot;)<br>
green_img = Image.fromarray(green).convert(&quot;L&quot;)<br>
blue_img = Image.fromarray((blue)).convert(&quot;L&quot;)</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Вы создаете
объект&nbsp;</span><span style='font-size:13.5pt;font-family:Consolas;
color:black'>Image</span><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>&nbsp;из каждого массива NumPy и конвертируете изображения в режим
«L», который представляет оттенки серого. Теперь вы можете объединить эти три
отдельных изображения в одно изображение RGB, используя&nbsp;</span><span
style='font-size:13.5pt;font-family:Consolas;color:black'>Image.merge()</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>&gt;&gt;&gt;
square_img = Image.merge(&quot;RGB&quot;, (red_img, green_img, blue_img))<br>
&gt;&gt;&gt; square_img<br>
&lt;PIL.Image.Image image mode=RGB size=600x600 at 0x7FC7C817B9D0&gt;<br>
<br>
&gt;&gt;&gt; square_img.show()</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Первый
аргумент в&nbsp;</span><span style='font-size:13.5pt;font-family:Consolas;
color:black'>Image.merge()</span><span style='font-size:13.5pt;font-family:
"Arial",sans-serif;color:black'>&nbsp;— это режим вывода изображения. Второй
аргумент — последовательность с отдельными изображениями. Этот код создает
следующее изображение:</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><img border=0 width=433 height=431 id="Рисунок 75"
src="PillowKAN.files/image044.jpg"><span style='font-size:13.5pt;font-family:
"Arial",sans-serif;color:black'> </span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>&nbsp;</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Вы
объединили отдельные режимы в цветное изображение RGB. В следующем разделе вы сделаете
еще один шаг и создадите GIF-анимацию с помощью NumPy и Pillow.</span></p>

<p class=MsoNormal style='margin-top:42.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:18.0pt;font-family:"Arial",sans-serif;color:black'>Создание
анимации</span></p>

<p class=MsoNormal style='margin-top:9.0pt;margin-right:0cm;margin-bottom:0cm;
margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>В
предыдущем разделе мы создали цветное изображение, содержащее три
перекрывающихся квадрата разных цветов. В этом разделе вы создадите анимацию,
показывающую, как эти три квадрата сливаются в один белый квадрат. Создадим
несколько версий изображений, содержащих три квадрата, и расположение квадратов
будет немного различаться между последовательными изображениями:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><b><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:#8959A8'>import</span></b><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'> numpy </span><b><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:#8959A8'>as</span></b><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'> np<br>
</span><b><span lang=EN-US style='font-size:10.0pt;font-family:Consolas;
color:#8959A8'>from</span></b><span lang=EN-US style='font-size:10.0pt;
font-family:Consolas;color:black'> PIL </span><b><span lang=EN-US
style='font-size:10.0pt;font-family:Consolas;color:#8959A8'>import</span></b><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'> Image<br>
<br>
square_animation = []<br>
</span><b><span lang=EN-US style='font-size:10.0pt;font-family:Consolas;
color:#8959A8'>for</span></b><span lang=EN-US style='font-size:10.0pt;
font-family:Consolas;color:black'> offset </span><b><span lang=EN-US
style='font-size:10.0pt;font-family:Consolas;color:#8959A8'>in</span></b><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'> range(0,
100, 2):<br>
    red = np.zeros((600, 600))<br>
    green = np.zeros((600, 600))<br>
    blue = np.zeros((600, 600))<br>
    red[101 + offset : 301 + offset, 101 + offset : 301 + offset] = 255<br>
    green[200:400, 200:400] = 255<br>
    blue[299 - offset : 499 - offset, 299 - offset : 499 - offset] = 255<br>
    red_img = Image.fromarray(red).convert(&quot;L&quot;)<br>
    green_img = Image.fromarray(green).convert(&quot;L&quot;)<br>
    blue_img = Image.fromarray((blue)).convert(&quot;L&quot;)<br>
    square_animation.append(<br>
        Image.merge(<br>
            &quot;RGB&quot;,<br>
            (red_img, green_img, blue_img)<br>
        )<br>
    )</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Вы создаете
пустой список с именем&nbsp;</span><span style='font-size:13.5pt;font-family:
Consolas;color:black'>Square_Animation</span><span style='font-size:13.5pt;
font-family:"Arial",sans-serif;color:black'>, который будет использоваться для
хранения различных изображений, которые вы создаете. В цикле&nbsp;</span><span
style='font-size:13.5pt;font-family:Consolas;color:black'>for</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>&nbsp;создаем
массивы NumPy для красного, зеленого и синего слоев, как мы это делали в
предыдущем разделе. Массив, содержащий зеленый слой, всегда один и тот же и
представляет собой квадрат в центре изображения.</span></p>

<p class=MsoNormal style='margin-top:18.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Красный
квадрат начинается со смещения влево вверх от центра. В каждом последующем
кадре красный квадрат перемещается ближе к центру, пока не достигнет центра в
последней итерации цикла. Синий квадрат сначала смещается в правый нижний угол,
а затем перемещается к центру с каждой итерацией.</span></p>

<p class=MsoNormal style='margin-top:18.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Обратите
внимание, что в этом примере вы перебираете диапазон (0, 100, 2), что означает,
что смещение переменной увеличивается с шагом в два. Ранее вы узнали, что вы
можете сохранить объект изображения в файл, используя&nbsp;</span><span
style='font-size:13.5pt;font-family:Consolas;color:black'>Image.save()</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>. Вы можете
использовать ту же функцию для сохранения файла GIF, содержащего
последовательность изображений. Вы вызываете&nbsp;</span><span
style='font-size:13.5pt;font-family:Consolas;color:black'>Image.save()</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>&nbsp;для
первого изображения в последовательности, которое является первым изображением,
которое вы сохранили в списке&nbsp;</span><span style='font-size:13.5pt;
font-family:Consolas;color:black'>Square_Animation</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>:</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>square_animation[0].save(<br>
    &quot;animation.gif&quot;, save_all=</span><b><span lang=EN-US
style='font-size:10.0pt;font-family:Consolas;color:#8959A8'>True</span></b><span
lang=EN-US style='font-size:10.0pt;font-family:Consolas;color:black'>,
append_images=square_animation[1:]<br>
)</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Первый
аргумент в&nbsp;</span><span style='font-size:13.5pt;font-family:Consolas;
color:black'>.save()</span><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>&nbsp;— это имя файла, который вы хотите сохранить. Расширение в
имени файла сообщает&nbsp;</span><span style='font-size:13.5pt;font-family:
Consolas;color:black'>.save()</span><span style='font-size:13.5pt;font-family:
"Arial",sans-serif;color:black'>, какой формат файла необходимо вывести. Вы
также включаете два аргумента ключевого слова в .</span><span style='font-size:
13.5pt;font-family:Consolas;color:black'>save()</span><span style='font-size:
13.5pt;font-family:"Arial",sans-serif;color:black'>:</span></p>

<ul style='margin-top:0cm' type=disc>
 <li class=MsoNormal style='color:black;margin-bottom:0cm;margin-bottom:.0001pt;
     line-height:normal;background:white'><span style='font-size:13.5pt;
     font-family:Consolas'>save_all=True</span><span style='font-size:13.5pt;
     font-family:"Arial",sans-serif'>&nbsp;гарантирует, что будут сохранены все
     изображения в последовательности, а не только первое.</span></li>
 <li class=MsoNormal style='color:black;margin-bottom:0cm;margin-bottom:.0001pt;
     line-height:normal;background:white'><span style='font-size:13.5pt;
     font-family:Consolas'>append_images=square_animation[1:]</span><span
     style='font-size:13.5pt;font-family:"Arial",sans-serif'>&nbsp;позволяет
     добавить оставшиеся изображения в последовательности в файл GIF.</span></li>
</ul>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>Этот код сохраняет анимацию.gif в файл, после чего вы можете
открыть файл GIF с помощью любого программного обеспечения для работы с
изображениями. GIF должен зацикливаться по умолчанию, но в некоторых системах
вам нужно будет добавить ключевой аргумент&nbsp;</span><span style='font-size:
13.5pt;font-family:Consolas;color:black'>loop=0</span><span style='font-size:
13.5pt;font-family:"Arial",sans-serif;color:black'>&nbsp;в .</span><span
style='font-size:13.5pt;font-family:Consolas;color:black'>save()</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>, чтобы
обеспечить зацикливание GIF. Анимация, которую вы получите, выглядит следующим
образом:</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>&nbsp;</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>&nbsp;</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'><img border=0 width=475 height=475
src="PillowKAN.files/image045.gif">сохраненная в gif анимация</span></p>

<p class=MsoNormal style='margin-top:24.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Три
квадрата разных цветов сливаются в один белый квадрат. Можете ли вы создать
свою собственную анимацию, используя разные формы и разные цвета?</span></p>

<p class=MsoNormal style='margin-top:42.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:18.0pt;font-family:"Arial",sans-serif;color:black'>Заключение</span></p>

<p class=MsoNormal style='margin-top:9.0pt;margin-right:0cm;margin-bottom:0cm;
margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Вы узнали,
как использовать Pillow для работы с изображениями и выполнения обработки. Если
вам понравилось работать с изображениями, вы можете с головой окунуться в мир
дизайна. Еще многое предстоит узнать о теории и практики обработки изображений.
Хорошей отправной точкой является &nbsp;</span><a
href="https://realpython.com/asins/9353062985/" target="_blank"><i><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;text-decoration:none'>Digital
Image Processing</span></i><span style='font-size:13.5pt;font-family:"Arial",sans-serif'>&nbsp;by
Gonzalez and Woods</span></a><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>, который является классическим учебником в этой области.</span></p>

<p class=MsoNormal style='margin-top:18.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Pillow — не
единственная библиотека, которую используется в Python для обработки
изображений. Если ваша цель состоит в том, чтобы выполнить некоторую базовую
обработку, то методы, которые вы изучили в этом руководстве, могут быть всем,
что вам нужно.</span></p>

<p class=MsoNormal style='margin-top:18.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Если вы
хотите углубиться в более продвинутые методы обработки изображений, например,
для приложений машинного обучения и компьютерного зрения, вы можете
использовать Pillow в качестве трамплина для других библиотек, таких как OpenCV
и scikit-image.</span></p>

<p class=MsoNormal style='margin-top:18.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><b><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>В этом
уроке вы узнали, как:</span></b></p>

<ul style='margin-top:0cm' type=disc>
 <li class=MsoNormal style='color:black;margin-bottom:0cm;margin-bottom:.0001pt;
     line-height:normal;background:white'><b><span style='font-size:13.5pt;
     font-family:"Arial",sans-serif'>Читать изображения</span></b><span
     style='font-size:13.5pt;font-family:"Arial",sans-serif'>&nbsp;с помощью
     Pillow</span></li>
 <li class=MsoNormal style='color:black;margin-bottom:0cm;margin-bottom:.0001pt;
     line-height:normal;background:white'><span style='font-size:13.5pt;
     font-family:"Arial",sans-serif'>Выполнять&nbsp;<b>основные операции</b>&nbsp;с
     изображениями</span></li>
 <li class=MsoNormal style='color:black;margin-bottom:0cm;margin-bottom:.0001pt;
     line-height:normal;background:white'><span style='font-size:13.5pt;
     font-family:"Arial",sans-serif'>Использовать Pilow для&nbsp;<b>обработки
     изображений</b></span></li>
 <li class=MsoNormal style='color:black;margin-bottom:0cm;margin-bottom:.0001pt;
     line-height:normal;background:white'><span style='font-size:13.5pt;
     font-family:"Arial",sans-serif'>Используйте&nbsp;<b>NumPy</b>&nbsp;с
     Pillow для&nbsp;<b>дальнейшей обработки</b></span></li>
 <li class=MsoNormal style='color:black;margin-bottom:0cm;margin-bottom:.0001pt;
     line-height:normal;background:white'><b><span style='font-size:13.5pt;
     font-family:"Arial",sans-serif'>Создавать анимации</span></b><span
     style='font-size:13.5pt;font-family:"Arial",sans-serif'>&nbsp;с помощью
     Pillow</span></li>
</ul>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;background:white'><span style='font-size:13.5pt;font-family:"Arial",sans-serif;
color:black'>Теперь просмотрите изображения на вашем компьютере и выберите
несколько, которые вы можете прочитать как изображения с помощью Pillow.
Решите, как вы хотите обработать эти изображения, а затем выполните некоторую
обработку. Удачи!</span></p>

<p class=MsoNormal style='margin-top:42.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:18.0pt;font-family:"Arial",sans-serif;color:black'>Примечания</span></p>

<p class=MsoNormal style='margin-top:9.0pt;margin-right:0cm;margin-bottom:0cm;
margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Метод&nbsp;</span><span
style='font-size:13.5pt;font-family:Consolas;color:black'>img.transpose(Image.FLIP_TOP_BOTTOM)</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>является устаревшим
(приведен в первой главе). Вместо данной строки вводите&nbsp;</span><span
style='font-size:13.5pt;font-family:Consolas;color:black'>img.transpose(Image.Transpose.FLIP_TOP_BOTTOM)</span><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>.</span></p>

<p class=MsoNormal style='margin-top:18.0pt;margin-right:0cm;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;line-height:normal;background:white'><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>Если&nbsp;</span><span
style='font-size:13.5pt;font-family:Consolas;color:black'>img.show()</span><i><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>&nbsp;</span></i><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>не работает
в вашей системе, то используйте&nbsp;</span><span style='font-size:13.5pt;
font-family:Consolas;color:black'>img.save()</span><i><span style='font-size:
13.5pt;font-family:"Arial",sans-serif;color:black'>,&nbsp;</span></i><span
style='font-size:13.5pt;font-family:"Arial",sans-serif;color:black'>чтобы
сохранить и просмотреть полученное изображение.</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

</div>

</body>

</html>

